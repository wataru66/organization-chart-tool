<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="title">Organization Chart Tool</title>
    
    <!-- External CDN Dependencies -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* === EMBEDDED CSS FROM main.css === */
        
        /* CSSÂ§âÊï∞ */
        :root {
            --org-box-width: 85px;
            --org-box-height: 100px;
            --org-spacing-x: 120px;
            --org-spacing-y: 140px;
            --font-size-org: 12px;
            --font-size-name: 10px;
            --font-size-role: 9px;
            --box-border: #333;
            --box-bg: #f9f9f9;
            --header-bg: #4a5568;
            --header-color: white;
            --line-color: #333;
        }

        /* Âü∫Êú¨„Çπ„Çø„Ç§„É´ */
        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f7fafc;
            color: #2d3748;
        }

        /* „Ç≥„É≥„ÉÜ„Éä */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        /* „Éò„ÉÉ„ÉÄ„Éº */
        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #2d3748;
            margin-bottom: 10px;
        }

        /* „Éá„É¢„É¢„Éº„ÉâË°®Á§∫ */
        .demo-mode {
            background: #bee3f8;
            color: #2c5282;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
            margin-bottom: 20px;
            font-weight: bold;
        }

        /* „Éï„Ç°„Ç§„É´„Éâ„É≠„ÉÉ„Éó„Çæ„Éº„É≥ */
        .file-drop-zone {
            border: 2px dashed #cbd5e0;
            border-radius: 8px;
            padding: 25px;
            text-align: center;
            margin-bottom: 20px;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .file-drop-zone:hover {
            border-color: #4299e1;
        }

        .file-drop-zone.dragover {
            border-color: #4299e1;
            background: #ebf8ff;
        }

        /* „Ç≥„É≥„Éà„É≠„Éº„É´ */
        .controls {
            background: #f7fafc;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .control-group {
            display: inline-block;
            margin-right: 20px;
            margin-bottom: 10px;
        }

        .control-group label {
            display: inline-block;
            width: 100px;
            font-weight: bold;
            margin-right: 10px;
        }

        /* „Éï„Ç©„Éº„É†Ë¶ÅÁ¥† */
        select, button {
            padding: 8px 12px;
            border: 1px solid #cbd5e0;
            border-radius: 4px;
            background: white;
            font-size: 14px;
        }

        button {
            background: #4299e1;
            color: white;
            border: none;
            cursor: pointer;
            margin-right: 10px;
            transition: background 0.2s;
        }

        button:hover:not(:disabled) {
            background: #3182ce;
        }

        button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
        }

        .btn-success {
            background: #48bb78 !important;
        }

        .btn-success:hover {
            background: #38a169 !important;
        }

        .btn-secondary {
            background: #718096 !important;
        }

        .btn-secondary:hover {
            background: #4a5568 !important;
        }

        .btn-warning {
            background: #ed8936 !important;
        }

        .btn-warning:hover {
            background: #dd6b20 !important;
        }

        .btn-danger {
            background: #e53e3e !important;
            color: white !important;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .btn-danger:hover {
            background: #c53030 !important;
        }

        .btn-info {
            background: #3182ce !important;
            color: white !important;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
        }

        .btn-info:hover {
            background: #2c5282 !important;
        }

        .btn-info:disabled {
            background: #a0aec0 !important;
            cursor: not-allowed;
        }

        /* Áµ±Ë®àÊÉÖÂ†± */
        .stats {
            background: #e6fffa;
            color: #234e52;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #38b2ac;
        }

        /* „Ç®„É©„ÉºË°®Á§∫ */
        .error {
            background: #fed7d7;
            color: #c53030;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #e53e3e;
        }

        /* „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´„Çª„ÇØ„Ç∑„Éß„É≥ */
        .data-table-section {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .table-header {
            background: #edf2f7;
            padding: 15px 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-header h3 {
            margin: 0;
            color: #2d3748;
        }

        .table-controls {
            display: flex;
            gap: 10px;
        }

        .table-controls button {
            margin: 0;
            padding: 6px 12px;
            font-size: 13px;
        }

        .table-container {
            max-height: 400px;
            overflow: auto;
            padding: 0;
            position: relative;
        }

        /* „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´ */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .data-table th,
        .data-table td {
            border: 1px solid #e2e8f0;
            padding: 8px;
            text-align: left;
        }

        .data-table th {
            background: #edf2f7;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 2px solid #cbd5e0;
        }

        .data-table tbody {
            position: relative;
            z-index: 10;
        }

        .data-table input,
        .data-table select {
            border: 1px solid #cbd5e0;
            padding: 4px;
            font-size: 12px;
        }

        .data-table input:focus,
        .data-table select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 1px #4299e1;
        }

        /* „Éê„É™„Éá„Éº„Ç∑„Éß„É≥„Çπ„ÉÜ„Éº„Çø„Çπ */
        .status-valid {
            color: #38a169;
            font-weight: bold;
        }

        .status-invalid {
            color: #e53e3e;
            font-weight: bold;
        }

        .status-warning {
            color: #dd6b20;
            font-weight: bold;
        }

        /* „ÉÅ„É£„Éº„Éà„Ç≥„É≥„ÉÜ„Éä */
        .chart-container {
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            overflow: auto;
            background: white;
            min-height: 500px;
            position: relative;
        }

        #orgChart {
            position: relative;
            min-height: 500px;
        }

        /* Áï•Áß∞Âá°‰æã */
        .abbreviation-legend {
            margin-top: 20px;
            background: #f7fafc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        }

        .abbreviation-legend h4 {
            margin: 0 0 10px 0;
            color: #2d3748;
        }

        .legend-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .legend-table th,
        .legend-table td {
            border: 1px solid #e2e8f0;
            padding: 8px 12px;
            text-align: left;
        }

        .legend-table th {
            background: #edf2f7;
            font-weight: bold;
        }

        .abbr-short {
            font-weight: bold;
            color: #4299e1;
        }

        .abbr-full {
            color: #2d3748;
        }
        
        /* === EMBEDDED CSS FROM components.css === */
        
        /* „Éú„Çø„É≥„Ç∞„É´„Éº„Éó„Çπ„Çø„Ç§„É´ */
        .button-group {
            margin: 10px 0;
            padding: 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            background: #f8fafc;
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .group-title {
            margin: 0;
            font-size: 14px;
            font-weight: 600;
            color: #2d3748;
            white-space: nowrap;
            min-width: 220px;
            width: 220px;
            flex-shrink: 0;
            text-align: left;
        }

        .button-group button {
            margin: 0;
            padding: 8px 12px;
            border: 1px solid;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        /* „Éú„Çø„É≥„Ç´„É©„Éº„Ç∑„Çπ„ÉÜ„É† */
        .btn-primary {
            background-color: #3182ce;
            border-color: #3182ce;
            color: white;
        }

        .btn-primary:hover:not(:disabled) {
            background-color: #2c5aa0;
            border-color: #2c5aa0;
        }

        /* ÁÑ°ÂäπÂåñ„Åï„Çå„Åü„Éú„Çø„É≥ */
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #e2e8f0 !important;
            border-color: #e2e8f0 !important;
            color: #a0aec0 !important;
        }

        /* „Éò„ÉÉ„ÉÄ„Éº„Éà„ÉÉ„ÉóÔºà„Çø„Ç§„Éà„É´„Å®Ë®ÄË™û„Çª„É¨„ÇØ„Çø„ÉºÔºâ */
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            position: relative;
        }

        .header-top h1 {
            margin: 0;
            flex: 1;
            text-align: center;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            z-index: 1;
        }

        /* Ë®ÄË™û„Çª„É¨„ÇØ„Çø„ÉºË™øÊï¥ */
        #languageSelector {
            margin: 0 !important;
            position: relative;
            z-index: 2;
        }

        #languageSelector .language-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #languageSelector label {
            margin: 0 !important;
            font-size: 14px;
            font-weight: 600;
            color: #4a5568;
        }

        #languageSelector select {
            font-size: 13px;
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #cbd5e0;
            background: white;
        }

        /* „Éò„ÉÉ„ÉÄ„ÉºÊÉÖÂ†±Ôºà„Çµ„Éñ„Çø„Ç§„Éà„É´ + ‰ΩøÁî®ÊñπÊ≥ïÔºâ */
        .header-info {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 5px;
            color: #718096;
        }

        .header-info .separator {
            color: #cbd5e0;
            font-weight: bold;
        }

        .header-info #pageSubtitle {
            font-size: 14px;
            color: #4a5568;
        }

        .header-info #pageUsage {
            font-size: 13px;
            color: #718096;
        }

        /* ÁµÑÁπîÂõ≥ÁîüÊàê„Ç∞„É´„Éº„ÉóÂÜÖ„ÅÆ„É¨„Ç§„Ç¢„Ç¶„ÉàÔºà1Ë°åÈÖçÁΩÆÔºâ */
        .hide-managers-option {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 13px;
            font-weight: 500;
            color: #4a5568;
            cursor: pointer;
            padding: 6px 10px;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            background: #f7fafc;
            transition: all 0.2s ease;
            white-space: nowrap;
        }

        .hide-managers-option:hover {
            background: #edf2f7;
            border-color: #cbd5e0;
        }

        .hide-managers-option input[type="checkbox"] {
            margin: 0;
            transform: scale(1.0);
        }

        /* „Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫„Éª„Éú„ÉÉ„ÇØ„Çπ„Çµ„Ç§„Ç∫„ÅÆ„É©„Éô„É´ */
        .size-label {
            display: inline-block;
            min-width: 160px;
            width: 160px;
            text-align: right;
            padding-right: 10px;
            font-weight: 500;
            color: #4a5568;
        }

        /* ÁµÑÁπî„Éú„ÉÉ„ÇØ„Çπ */
        .org-box {
            position: absolute;
            width: var(--org-box-width);
            height: var(--org-box-height);
            border: 2px solid var(--box-border);
            background: var(--box-bg);
            border-radius: 4px;
            font-size: var(--font-size-org);
            display: flex;
            flex-direction: column;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            z-index: 10;
        }

        .org-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        /* ÁµÑÁπî„Éò„ÉÉ„ÉÄ„ÉºÔºà2Ë°åÂØæÂøúÔºâ */
        .org-header {
            background: var(--header-bg);
            color: var(--header-color);
            padding: 3px 4px;
            font-weight: bold;
            font-size: var(--font-size-org);
            text-align: center;
            border-radius: 2px 2px 0 0;
            min-height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            white-space: pre-line;
            line-height: 1.1;
            word-break: break-all;
            overflow-wrap: break-word;
        }

        /* ÁµÑÁπî„Ç≥„É≥„ÉÜ„É≥„ÉÑÔºàÂ∑¶Âè≥„Éë„Éá„Ç£„É≥„Ç∞Á∏ÆÂ∞èÔºâ */
        .org-content {
            padding: 4px 3px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            gap: 1px;
        }

        /* „ÉÅ„Éº„É†Èï∑ÂΩπËÅ∑Ôºà2Ë°åÂØæÂøúÔºâ */
        .org-manager-role {
            font-size: var(--font-size-role);
            font-weight: normal;
            text-align: left;
            color: #2d3748;
            margin-bottom: 1px;
            white-space: normal;
            line-height: 1.1;
            word-break: break-all;
            min-height: 14px;
        }

        /* „ÉÅ„Éº„É†Èï∑ÂêçÂâçÔºà2Ë°åÂØæÂøúÔºâ */
        .org-manager {
            font-size: var(--font-size-name);
            font-weight: bold;
            text-align: center;
            margin-bottom: 2px;
            color: #2d3748;
            white-space: normal;
            overflow: visible;
            line-height: 1.1;
            word-break: break-all;
            min-height: 16px;
        }

        /* „Ç¢„Éâ„Éê„Ç§„Ç∂ÂΩπËÅ∑Ôºà2Ë°åÂØæÂøúÔºâ */
        .org-advisor-role {
            font-size: calc(var(--font-size-role) * 0.85);
            font-weight: normal;
            text-align: left;
            color: #718096;
            margin-bottom: 1px;
            white-space: normal;
            overflow: visible;
            line-height: 1.1;
            word-break: break-all;
            min-height: 12px;
        }

        /* „Ç¢„Éâ„Éê„Ç§„Ç∂ÂêçÂâçÔºà2Ë°åÂØæÂøúÔºâ */
        .org-advisor {
            font-size: calc(var(--font-size-name) * 0.85);
            font-weight: normal;
            text-align: center;
            color: #718096;
            white-space: normal;
            overflow: visible;
            line-height: 1.1;
            word-break: break-all;
            min-height: 14px;
        }

        /* Á©∫„ÅÆË¶ÅÁ¥†Áî®„Çπ„Çø„Ç§„É´ */
        .org-empty {
            height: 1px;
            visibility: hidden;
        }

        /* Êé•Á∂öÁ∑ö */
        .connection-line {
            position: absolute;
            background: var(--line-color);
            z-index: 1;
        }

        .connection-line.horizontal {
            height: 2px;
        }

        .connection-line.vertical {
            width: 2px;
        }

        /* ÁµÑÁπî„É¨„Éô„É´Âà•„ÅÆ„Çπ„Çø„Ç§„É™„É≥„Ç∞Ôºà„Éá„Éï„Ç©„É´„ÉàËâ≤Ôºâ */
        .org-box[data-level="1"] .org-header {
            background: #2d3748;
        }

        .org-box[data-level="2"] .org-header {
            background: #4a5568;
        }

        .org-box[data-level="3"] .org-header {
            background: #718096;
        }

        .org-box[data-level="4"] .org-header {
            background: #a0aec0;
            color: #2d3748;
        }

        .org-box[data-level="5"] .org-header {
            background: #e2e8f0;
            color: #2d3748;
        }

        /* Ëâ≤ÂÖ•Âäõ„Ç≥„É≥„ÉÜ„Éä */
        .color-input-container {
            display: flex;
            align-items: center;
            gap: 6px;
            width: 140px;
        }

        .color-preview-box {
            width: 24px;
            height: 24px;
            border: 2px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
            background: #f9f9f9;
            transition: border-color 0.2s, transform 0.1s;
        }

        .color-preview-box.has-color {
            border-color: #666;
        }

        .color-preview-box:hover {
            border-color: #4299e1;
            transform: scale(1.05);
        }

        .color-text-input {
            flex: 1;
            min-width: 60px;
            font-family: monospace;
            font-size: 11px;
            padding: 2px 4px;
            border: 1px solid #cbd5e0;
            border-radius: 3px;
            transition: border-color 0.2s;
        }

        .color-text-input:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 1px #4299e1;
        }

        .color-picker-btn {
            background: #4299e1;
            color: white;
            border: none;
            padding: 4px 6px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
            flex-shrink: 0;
            transition: background 0.2s;
        }

        .color-picker-btn:hover {
            background: #3182ce;
        }

        /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 10px;
            }
            
            .control-group {
                display: block;
                margin-bottom: 15px;
            }
            
            .control-group label {
                display: block;
                width: auto;
                margin-bottom: 5px;
            }
            
            .table-header {
                flex-direction: column;
                gap: 10px;
                align-items: flex-start;
            }
            
            .table-controls {
                flex-wrap: wrap;
            }
            
            .table-container {
                padding: 10px;
            }
        }

        /* Âç∞Âà∑Áî®„Çπ„Çø„Ç§„É´ */
        @media print {
            .controls,
            .file-drop-zone,
            .stats,
            .error,
            .data-table-section {
                display: none !important;
            }
            
            .container {
                box-shadow: none;
                margin: 0;
                padding: 0;
            }
            
            .chart-container {
                border: none;
                overflow: visible;
            }
        }

        /* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .data-table-section {
            animation: fadeIn 0.3s ease-out;
        }

        /* „Çπ„ÇØ„É≠„Éº„É´„Éê„Éº„ÅÆ„Ç´„Çπ„Çø„Éû„Ç§„Ç∫ */
        .table-container::-webkit-scrollbar,
        .chart-container::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        .table-container::-webkit-scrollbar-track,
        .chart-container::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb,
        .chart-container::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }

        .table-container::-webkit-scrollbar-thumb:hover,
        .chart-container::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }

        /* Usage Instructions Styles */
        .usage-instructions {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            animation: fadeIn 0.3s ease-out;
        }

        .usage-instructions h3 {
            color: #2d3748;
            margin: 0 0 20px 0;
            font-size: 18px;
            border-bottom: 2px solid #4299e1;
            padding-bottom: 10px;
        }

        .instruction-section {
            margin-bottom: 20px;
            background: white;
            border-radius: 6px;
            padding: 15px;
            border-left: 4px solid #4299e1;
        }

        .instruction-section h4 {
            color: #2d3748;
            margin: 0 0 10px 0;
            font-size: 16px;
        }

        .instruction-section ul {
            margin: 0;
            padding-left: 20px;
        }

        .instruction-section li {
            margin-bottom: 8px;
            line-height: 1.5;
            color: #4a5568;
        }

        .show-instructions-container {
            text-align: center;
            margin: 15px 0;
        }

        /* Validation section highlighting */
        .instruction-section:has([data-i18n="validationTitle"]) {
            border-left-color: #f56565;
            background: #fef5f5;
        }

        /* Features section highlighting */
        .instruction-section:has([data-i18n="featuresTitle"]) {
            border-left-color: #48bb78;
            background: #f0fff4;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-top">
                <h1 id="pageTitle" data-i18n="title">Organization Chart Tool</h1>
                <!-- Language selector will be injected here by LanguageManager -->
            </div>
            <div class="header-info">
                <span id="pageSubtitle" data-i18n="subtitle">Automatically generate organization charts from Excel files</span>
                <span class="separator">|</span>
                <small id="pageUsage" data-i18n-html="usage">üí° <strong>Usage:</strong> 1Ô∏è‚É£ Select file ‚Üí 2Ô∏è‚É£ Validate data ‚Üí 3Ô∏è‚É£ Generate chart ‚Üí 4Ô∏è‚É£ Export</small>
            </div>

            <!-- Detailed Usage Instructions -->
            <div id="usageInstructions" class="usage-instructions" style="display: none;">
                <h3 data-i18n="detailedUsageTitle">Detailed Usage Instructions</h3>
                
                <div class="instruction-section">
                    <h4 data-i18n="step1Title">1Ô∏è‚É£ Data Input</h4>
                    <ul>
                        <li data-i18n="step1Item1">Upload Excel file (.xlsx, .xls) or use sample data</li>
                        <li data-i18n="step1Item2">Drag and drop files directly onto the drop zone</li>
                        <li data-i18n="step1Item3">Use "Load Sample Data" to try with demo data (500-person manufacturing company)</li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h4 data-i18n="step2Title">2Ô∏è‚É£ Data Validation</h4>
                    <ul>
                        <li data-i18n="step2Item1">Click "Validate Data" to check for errors and inconsistencies</li>
                        <li data-i18n="step2Item2">Use "Show/Edit Data Table" to review and modify data</li>
                        <li data-i18n="step2Item3">Fix any validation errors before generating charts</li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h4 data-i18n="step3Title">3Ô∏è‚É£ Chart Generation</h4>
                    <ul>
                        <li data-i18n="step3Item1">Select base organization (optional - leave blank for full chart)</li>
                        <li data-i18n="step3Item2">Set level limit to control chart depth</li>
                        <li data-i18n="step3Item3">Toggle "Hide Managers" to show organization structure only</li>
                        <li data-i18n="step3Item4">Adjust font size and box size for optimal display</li>
                        <li data-i18n="step3Item5">Click "Generate Chart" to create the visualization</li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h4 data-i18n="step4Title">4Ô∏è‚É£ Export & Output</h4>
                    <ul>
                        <li data-i18n="step4Item1">Export as SVG for scalable vector graphics</li>
                        <li data-i18n="step4Item2">Export as PNG for raster images (requires html2canvas)</li>
                        <li data-i18n="step4Item3">Print directly from browser</li>
                        <li data-i18n="step4Item4">Use Full Screen mode for better viewing</li>
                        <li data-i18n="step4Item5">Export current data back to Excel format</li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h4 data-i18n="validationTitle">üìã Data Validation Checks</h4>
                    <ul>
                        <li data-i18n="validation1">Required fields check: Name, Call Name, and Role must be filled</li>
                        <li data-i18n="validation2">Circular reference detection: Prevents infinite loops in hierarchy</li>
                        <li data-i18n="validation3">Orphaned organizations: Checks for invalid parent organization references</li>
                        <li data-i18n="validation4">Duplicate detection: Ensures no conflicting roles within same organization</li>
                        <li data-i18n="validation5">Level consistency: Verifies proper hierarchical level ordering</li>
                        <li data-i18n="validation6">Team boss validation: Ensures only one team boss per organization</li>
                        <li data-i18n="validation7">Color format validation: Checks custom color values (HEX, RGB, color names)</li>
                        <li data-i18n="validation8">Role combination validation: Validates manager/advisor combinations</li>
                        <li data-i18n="validation9">Data type validation: Ensures proper data types for each field</li>
                        <li data-i18n="validation10">Hierarchy depth check: Validates reasonable organizational depth</li>
                    </ul>
                </div>

                <div class="instruction-section">
                    <h4 data-i18n="featuresTitle">üåü Key Features</h4>
                    <ul>
                        <li data-i18n="feature1">Multi-language support: English, Japanese, Indonesian</li>
                        <li data-i18n="feature2">Automatic language detection and persistence</li>
                        <li data-i18n="feature3">Custom color system with palette and presets</li>
                        <li data-i18n="feature4">Responsive design for various screen sizes</li>
                        <li data-i18n="feature5">Real-time data validation and error reporting</li>
                        <li data-i18n="feature6">Flexible organizational hierarchy display</li>
                        <li data-i18n="feature7">Professional export options (SVG, PNG, HTML)</li>
                        <li data-i18n="feature8">Team boss and advisor role management</li>
                    </ul>
                </div>

                <button onclick="toggleUsageInstructions()" class="btn-secondary" data-i18n="hideInstructions">Hide Instructions</button>
            </div>

            <div class="show-instructions-container">
                <button onclick="toggleUsageInstructions()" class="btn-info" data-i18n="showDetailedInstructions">Show Detailed Instructions</button>
            </div>
        </div>

        <!-- Demo mode display -->
        <div id="demoMode" class="demo-mode" style="display: none;" data-i18n="demoMode">
            Demo Mode: Running with sample data
        </div>

        <!-- File drop zone -->
        <div id="dropZone" class="file-drop-zone">
            <p id="dropZoneText" data-i18n="fileDropZone">üìÅ Drop Excel file here or click to select</p>
            <p id="supportedFormats" data-i18n="supportedFormats">Supported formats: .xlsx, .xls</p>
            <input type="file" id="fileInput" accept=".xlsx,.xls" style="display: none;">
        </div>

        <!-- Controls -->
        <div class="controls">
            <div class="control-group">
                <label for="baseOrgSelect" id="baseOrgLabel" data-i18n="baseOrganization">Base Organization:</label>
                <select id="baseOrgSelect">
                    <option value="" id="showAllOption" data-i18n="showAll">Show All</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="levelSelect" id="levelLimitLabel" data-i18n="levelLimit">Level Limit:</label>
                <select id="levelSelect">
                    <option value="0" data-i18n="noLimit">No Limit</option>
                    <option value="3" data-i18n="levelsUpTo" data-i18n-params='{"n":3}'>Up to 3 levels</option>
                    <option value="4" data-i18n="levelsUpTo" data-i18n-params='{"n":4}'>Up to 4 levels</option>
                    <option value="5" selected data-i18n="levelsUpTo" data-i18n-params='{"n":5}'>Up to 5 levels</option>
                    <option value="6" data-i18n="levelsUpTo" data-i18n-params='{"n":6}'>Up to 6 levels</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="fontSizeSelect" id="fontSizeLabel" class="size-label" data-i18n="fontSize">Font Size:</label>
                <select id="fontSizeSelect">
                    <option value="small" data-i18n="small">Small</option>
                    <option value="medium" selected data-i18n="medium">Medium</option>
                    <option value="large" data-i18n="large">Large</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="boxSizeSelect" id="boxSizeLabel" class="size-label" data-i18n="boxSize">Box Size:</label>
                <select id="boxSizeSelect">
                    <option value="small" data-i18n="small">Small</option>
                    <option value="medium" selected data-i18n="medium">Medium</option>
                    <option value="large" data-i18n="large">Large</option>
                </select>
            </div>
            
            <!-- „Éá„Éº„ÇøÊìç‰Ωú„Ç∞„É´„Éº„Éó -->
            <div class="button-group data-operations">
                <h4 class="group-title" data-i18n="dataOperations">üìÅ Data Operations</h4>
                <button onclick="loadSampleData()" class="btn-primary" data-i18n="loadSampleData">
                    Load Sample Data
                </button>
                <button onclick="exportEmptyTemplate()" class="btn-primary" data-i18n="exportEmptyTemplate">
                    Export Empty Template
                </button>
                <button onclick="exportCurrentData()" disabled id="exportCurrentDataBtn" class="btn-primary" data-i18n="exportCurrentData">
                    Export Current Data
                </button>
            </div>

            <!-- „Éá„Éº„ÇøÁ∑®ÈõÜ„ÉªÊ§úË®º„Ç∞„É´„Éº„Éó -->
            <div class="button-group data-editing">
                <h4 class="group-title" data-i18n="dataEditingValidation">üõ†Ô∏è Data Editing & Validation</h4>
                <button id="showTableBtn" onclick="showDataTable()" disabled class="btn-primary" data-i18n="showDataTable">
                    Show/Edit Data Table
                </button>
                <button id="validateBtn" onclick="validateData()" disabled class="btn-primary" data-i18n="validateData">
                    Validate Data
                </button>
            </div>

            <!-- ÁµÑÁπîÂõ≥ÁîüÊàê„Ç∞„É´„Éº„Éó -->
            <div class="button-group chart-generation">
                <h4 class="group-title" data-i18n="chartGeneration">üéØ Chart Generation</h4>
                <label for="hideManagersCheckbox" id="hideManagersLabel" class="hide-managers-option">
                    <input type="checkbox" id="hideManagersCheckbox"> 
                    <span data-i18n="hideManagers">Hide Managers</span>
                </label>
                <button id="generateBtn" onclick="generateChart()" disabled class="btn-primary" data-i18n="generateChart">
                    Generate Chart
                </button>
                <button onclick="toggleFullscreen()" disabled id="fullscreenBtn" class="btn-primary" data-i18n="fullScreen">
                    Full Screen
                </button>
            </div>

            <!-- „Ç®„ÇØ„Çπ„Éù„Éº„Éà„ÉªÂá∫Âäõ„Ç∞„É´„Éº„Éó -->
            <div class="button-group export-output">
                <h4 class="group-title" data-i18n="exportOutput">üì§ Export & Output</h4>
                <button id="exportSvgBtn" onclick="exportSVG()" disabled class="btn-info" data-i18n="exportSVG">
                    Export SVG
                </button>
                <button id="exportPngBtn" onclick="exportPNG()" disabled class="btn-info" data-i18n="exportPNG">
                    Export PNG
                </button>
                <button onclick="exportHTML()" disabled id="exportHTMLBtn" class="btn-info" data-i18n="exportHTML">
                    Export HTML
                </button>
                <button id="printBtn" onclick="printChart()" disabled class="btn-info" data-i18n="print">
                    Print
                </button>
            </div>

        </div>

        <!-- Statistics -->
        <div id="stats" class="stats" style="display: none;">
            <strong>üìä Data Statistics:</strong>
            <span id="statsContent"></span>
        </div>

        <!-- Error display -->
        <div id="errors" class="errors" style="display: none;"></div>

        <!-- Data table section -->
        <div id="dataTableSection" class="data-table-section" style="display: none;">
            <div class="table-header">
                <h3 id="dataTableTitle" data-i18n="dataTableTitle">Data Table - Validation & Edit</h3>
                <div class="table-controls">
                    <button onclick="addNewRow()" class="btn-success" data-i18n="addNewRow">Add New Row</button>
                    <button onclick="applyChanges()" class="btn-success" data-i18n="applyChanges">Apply Changes</button>
                    <button onclick="hideDataTable()" class="btn-secondary" data-i18n="closeTable">Close Table</button>
                </div>
            </div>
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th data-i18n="tableHeaders.actions">Actions</th>
                            <th data-i18n="tableHeaders.level">Level</th>
                            <th data-i18n="tableHeaders.employeeId">Employee ID</th>
                            <th data-i18n="tableHeaders.name">Name</th>
                            <th data-i18n="tableHeaders.nameEn">Name (EN)</th>
                            <th data-i18n="tableHeaders.grade">Grade</th>
                            <th data-i18n="tableHeaders.teamLongName">Team Long Name</th>
                            <th data-i18n="tableHeaders.callName">Call Name</th>
                            <th data-i18n="tableHeaders.concurrent">Concurrent</th>
                            <th data-i18n="tableHeaders.parent">Parent Org</th>
                            <th data-i18n="tableHeaders.role">Role</th>
                            <th data-i18n="tableHeaders.roleJp">Role (JP)</th>
                            <th>Team Boss</th>
                            <th data-i18n="tableHeaders.borderColor">Border Colorüé®</th>
                            <th data-i18n="tableHeaders.backgroundColor">Header BG Colorüé®</th>
                            <th data-i18n="tableHeaders.headerTextColor">Header Text Colorüé®</th>
                            <th data-i18n="tableHeaders.status">Status</th>
                        </tr>
                    </thead>
                    <tbody id="dataTableBody">
                        <!-- Data rows will be dynamically generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Organization chart display area -->
        <div class="chart-container">
            <div id="orgChart"></div>
        </div>
    </div>

    <!-- EMBEDDED JAVASCRIPT -->
    <script>
        // === EMBEDDED JAVASCRIPT FROM CONFIG.JS ===
        
        /**
         * Organization Chart Tool - Configuration File (Color System Version)
         * Manages application settings and demo data
         */

        // Language definitions
        const LANG = {
            en: {
                languageLabel: "Language:",
                title: "Organization Chart Tool",
                subtitle: "Automatically generate organization charts from Excel files",
                usage: "Usage: 1Ô∏è‚É£ Select file ‚Üí 2Ô∏è‚É£ Validate data ‚Üí 3Ô∏è‚É£ Generate chart ‚Üí 4Ô∏è‚É£ Export",
                demoMode: "Demo Mode: Running with sample data",
                fileDropZone: "üìÅ Drop Excel file here or click to select",
                supportedFormats: "Supported formats: .xlsx, .xls",
                baseOrganization: "Base Organization:",
                showAll: "Show All",
                levelLimit: "Level Limit:",
                noLimit: "No Limit",
                levelsUpTo: "Up to {{n}} levels",
                fontSize: "Font Size:",
                boxSize: "Box Size:",
                hideManagers: "Hide Managers",
                small: "Small",
                medium: "Medium",
                large: "Large",
                generateChart: "Generate Chart",
                showDataTable: "Show/Edit Data Table",
                validateData: "Validate Data",
                exportSVG: "Export SVG",
                exportPNG: "Export PNG",
                print: "Print",
                fullScreen: "Full Screen",
                exitFullScreen: "Exit Full Screen",
                loadSampleData: "Load Sample Data",
                dataTableTitle: "Data Table - Validation & Edit",
                addNewRow: "Add New Row",
                applyChanges: "Apply Changes",
                closeTable: "Close Table",
                tableHeaders: {
                    actions: "Actions",
                    level: "Level",
                    employeeId: "Employee ID",
                    name: "Name",
                    nameEn: "Name (EN)",
                    grade: "Grade",
                    teamLongName: "Team Long Name",
                    callName: "Call Name",
                    concurrent: "Concurrent",
                    parent: "Parent Org",
                    role: "Role",
                    roleJp: "Role (JP)",
                    borderColor: "Border Colorüé®",
                    backgroundColor: "Header BG Colorüé®",
                    headerTextColor: "Header Text Colorüé®",
                    status: "Status"
                },
                valid: "OK",
                invalid: "Error",
                warning: "Warning",
                pending: "Pending",
                delete: "Delete",
                selectPlease: "Please select",
                success: "Success!",
                error: "Error",
                noDataLoaded: "No data loaded. Please select an Excel file first.",
                fileLoadComplete: 'File "{{filename}}" loaded successfully.',
                chartGenerated: "Chart generated ({{count}} organizations)",
                changesApplied: "Changes applied successfully\\n{{count}} rows of data applied (Custom colors: {{customColors}} organizations)\\n\\nClick 'Generate Chart' to see the updated chart.",
                nameRequired: "Name is required",
                callNameRequired: "Call Name is required",
                roleRequired: "Role is required",
                levelOutOfRange: "Level must be between 1-10",
                parentNotFound: "Parent organization (Call Name) not found",
                circularReference: "Circular reference detected",
                invalidColorFormat: "Invalid {{field}} format: {{value}}",
                colorValidationError: "{{field}} validation error: {{error}}",
                exportStarted: "Download started",
                exportEmptyTemplate: "Export Empty Template",
                exportCurrentData: "Export Current Data",
                exportHTML: "Export HTML",
                emptyTemplateExported: "Empty template \\\"{{filename}}\\\" exported successfully.",
                currentDataExported: "Current data \\\"{{filename}}\\\" exported successfully.",
                htmlExported: "Standalone HTML \\\"{{filename}}\\\" exported successfully.",
                pngExportRequiresLib: "PNG export requires html2canvas library.<br>Please use SVG export instead.",
                selectColor: "Select {{field}}",
                departmentPresets: "Department Presets",
                colorPalette: "Color Palette",
                customColor: "Custom Color",
                apply: "Apply",
                clearColor: "Clear Color (Use Default)",
                callNameLegend: "Call Name - Full Name Reference",
                colorLegend: "Color Coding",
                customColorUsage: "Custom colors: {{count}} organizations, {{patterns}} patterns",
                organizationOnly: "Organization Only",
                dataOperations: "üìÅ Data Operations",
                dataEditingValidation: "üõ†Ô∏è Data Editing & Validation",
                chartGeneration: "üéØ Chart Generation",
                exportOutput: "üì§ Export & Output",
                displayControl: "üñ•Ô∏è Display Control",
                
                // Detailed Instructions
                detailedUsageTitle: "Detailed Usage Instructions",
                showDetailedInstructions: "Show Detailed Instructions",
                hideInstructions: "Hide Instructions",
                
                step1Title: "1Ô∏è‚É£ Data Input",
                step1Item1: "Upload Excel file (.xlsx, .xls) or use sample data",
                step1Item2: "Drag and drop files directly onto the drop zone",
                step1Item3: "Use \"Load Sample Data\" to try with demo data (500-person manufacturing company)",
                
                step2Title: "2Ô∏è‚É£ Data Validation",
                step2Item1: "Click \"Validate Data\" to check for errors and inconsistencies",
                step2Item2: "Use \"Show/Edit Data Table\" to review and modify data",
                step2Item3: "Fix any validation errors before generating charts",
                
                step3Title: "3Ô∏è‚É£ Chart Generation",
                step3Item1: "Select base organization (optional - leave blank for full chart)",
                step3Item2: "Set level limit to control chart depth",
                step3Item3: "Toggle \"Hide Managers\" to show organization structure only",
                step3Item4: "Adjust font size and box size for optimal display",
                step3Item5: "Click \"Generate Chart\" to create the visualization",
                
                step4Title: "4Ô∏è‚É£ Export & Output",
                step4Item1: "Export as SVG for scalable vector graphics",
                step4Item2: "Export as PNG for raster images (requires html2canvas)",
                step4Item3: "Print directly from browser",
                step4Item4: "Use Full Screen mode for better viewing",
                step4Item5: "Export current data back to Excel format",
                
                validationTitle: "üìã Data Validation Checks",
                validation1: "Required fields check: Name, Call Name, and Role must be filled",
                validation2: "Circular reference detection: Prevents infinite loops in hierarchy",
                validation3: "Orphaned organizations: Checks for invalid parent organization references",
                validation4: "Duplicate detection: Ensures no conflicting roles within same organization",
                validation5: "Level consistency: Verifies proper hierarchical level ordering",
                validation6: "Team boss validation: Ensures only one team boss per organization",
                validation7: "Color format validation: Checks custom color values (HEX, RGB, color names)",
                validation8: "Role combination validation: Validates manager/advisor combinations",
                validation9: "Data type validation: Ensures proper data types for each field",
                validation10: "Hierarchy depth check: Validates reasonable organizational depth",
                
                featuresTitle: "üåü Key Features",
                feature1: "Multi-language support: English, Japanese, Indonesian",
                feature2: "Automatic language detection and persistence",
                feature3: "Custom color system with palette and presets",
                feature4: "Responsive design for various screen sizes",
                feature5: "Real-time data validation and error reporting",
                feature6: "Flexible organizational hierarchy display",
                feature7: "Professional export options (SVG, PNG, HTML)",
                feature8: "Team boss and advisor role management"
            },
            ja: {
                languageLabel: "Ë®ÄË™û:",
                title: "ÁµÑÁπîÂõ≥‰ΩúÊàê„ÉÑ„Éº„É´",
                subtitle: "Excel„Éï„Ç°„Ç§„É´„Åã„ÇâÁµÑÁπîÂõ≥„ÇíËá™ÂãïÁîüÊàê",
                usage: "‰ΩøÁî®ÊñπÊ≥ï: 1Ô∏è‚É£ „Éï„Ç°„Ç§„É´ÈÅ∏Êäû ‚Üí 2Ô∏è‚É£ „Éá„Éº„ÇøÊ§úË®º ‚Üí 3Ô∏è‚É£ ÁµÑÁπîÂõ≥ÁîüÊàê ‚Üí 4Ô∏è‚É£ „Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                demoMode: "„Éá„É¢„É¢„Éº„Éâ: „Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÅßÂÆüË°å‰∏≠",
                fileDropZone: "üìÅ Excel„Éï„Ç°„Ç§„É´„Çí„Åì„Åì„Å´„Éâ„É≠„ÉÉ„Éó„Åæ„Åü„ÅØ„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÈÅ∏Êäû",
                supportedFormats: "ÂØæÂøúÂΩ¢Âºè: .xlsx, .xls",
                baseOrganization: "Âü∫Ê∫ñÁµÑÁπî:",
                showAll: "„Åô„Åπ„Å¶Ë°®Á§∫",
                levelLimit: "„É¨„Éô„É´Âà∂Èôê:",
                noLimit: "Âà∂Èôê„Å™„Åó",
                levelsUpTo: "{{n}}„É¨„Éô„É´„Åæ„Åß",
                fontSize: "„Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫:",
                boxSize: "„Éú„ÉÉ„ÇØ„Çπ„Çµ„Ç§„Ç∫:",
                hideManagers: "ÁÆ°ÁêÜËÄÖ„ÇíÈùûË°®Á§∫",
                small: "Â∞è",
                medium: "‰∏≠",
                large: "Â§ß",
                generateChart: "ÁµÑÁπîÂõ≥ÁîüÊàê",
                showDataTable: "„Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´Ë°®Á§∫/Á∑®ÈõÜ",
                validateData: "„Éá„Éº„ÇøÊ§úË®º",
                exportSVG: "SVG„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                exportPNG: "PNG„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                print: "Âç∞Âà∑",
                fullScreen: "„Éï„É´„Çπ„ÇØ„É™„Éº„É≥",
                exitFullScreen: "„Éï„É´„Çπ„ÇØ„É™„Éº„É≥ÁµÇ‰∫Ü",
                loadSampleData: "„Çµ„É≥„Éó„É´„Éá„Éº„ÇøË™≠„ÅøËæº„Åø",
                dataTableTitle: "„Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´ - Ê§úË®º„Å®Á∑®ÈõÜ",
                addNewRow: "Êñ∞Ë¶èË°åËøΩÂä†",
                applyChanges: "Â§âÊõ¥„ÇíÈÅ©Áî®",
                closeTable: "„ÉÜ„Éº„Éñ„É´„ÇíÈñâ„Åò„Çã",
                tableHeaders: {
                    actions: "Êìç‰Ωú",
                    level: "„É¨„Éô„É´",
                    employeeId: "Á§æÂì°ID",
                    name: "ÂêçÂâç",
                    nameEn: "ÂêçÂâçÔºàËã±Ë™ûÔºâ",
                    grade: "Á≠âÁ¥ö",
                    teamLongName: "Ê≠£ÂºèÁµÑÁπîÂêç",
                    callName: "Call Name",
                    concurrent: "ÂÖº‰ªª",
                    parent: "‰∏ä‰ΩçÁµÑÁπî",
                    role: "ÂΩπËÅ∑",
                    roleJp: "ÂΩπËÅ∑ÔºàÊó•Êú¨Ë™ûÔºâ",
                    borderColor: "Êû†Á∑öËâ≤üé®",
                    backgroundColor: "„Éò„ÉÉ„ÉÄ„ÉºËÉåÊôØËâ≤üé®",
                    headerTextColor: "„Éò„ÉÉ„ÉÄ„ÉºÊñáÂ≠óËâ≤üé®",
                    status: "Áä∂ÊÖã"
                },
                valid: "OK",
                invalid: "„Ç®„É©„Éº",
                warning: "Ë≠¶Âëä",
                pending: "‰øùÁïô‰∏≠",
                delete: "ÂâäÈô§",
                selectPlease: "ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
                success: "ÊàêÂäüÔºÅ",
                error: "„Ç®„É©„Éº",
                noDataLoaded: "„Éá„Éº„Çø„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì„ÄÇÊúÄÂàù„Å´Excel„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",
                fileLoadComplete: '„Éï„Ç°„Ç§„É´ "{{filename}}" „ÅåÊ≠£Â∏∏„Å´Ë™≠„ÅøËæº„Åæ„Çå„Åæ„Åó„Åü„ÄÇ',
                chartGenerated: "ÁµÑÁπîÂõ≥„ÅåÁîüÊàê„Åï„Çå„Åæ„Åó„ÅüÔºà{{count}}ÁµÑÁπîÔºâ",
                changesApplied: "Â§âÊõ¥„ÅåÊ≠£Â∏∏„Å´ÈÅ©Áî®„Åï„Çå„Åæ„Åó„Åü\\n{{count}}Ë°å„ÅÆ„Éá„Éº„Çø„ÅåÈÅ©Áî®„Åï„Çå„Åæ„Åó„ÅüÔºà„Ç´„Çπ„Çø„É†Ëâ≤: {{customColors}}ÁµÑÁπîÔºâ\\n\\n„ÄåÁµÑÁπîÂõ≥ÁîüÊàê„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Êõ¥Êñ∞„Åï„Çå„ÅüÁµÑÁπîÂõ≥„ÇíÁ¢∫Ë™ç„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ",
                nameRequired: "ÂêçÂâç„ÅØÂøÖÈ†à„Åß„Åô",
                callNameRequired: "Call Name„ÅØÂøÖÈ†à„Åß„Åô",
                roleRequired: "ÂΩπËÅ∑„ÅØÂøÖÈ†à„Åß„Åô",
                levelOutOfRange: "„É¨„Éô„É´„ÅØ1-10„ÅÆÁØÑÂõ≤„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ",
                parentNotFound: "‰∏ä‰ΩçÁµÑÁπîÔºàCall NameÔºâ„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì",
                circularReference: "Âæ™Áí∞ÂèÇÁÖß„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„Åü",
                invalidColorFormat: "ÁÑ°Âäπ„Å™{{field}}ÂΩ¢Âºè: {{value}}",
                colorValidationError: "{{field}}Ê§úË®º„Ç®„É©„Éº: {{error}}",
                exportStarted: "„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÇíÈñãÂßã„Åó„Åæ„Åó„Åü",
                exportEmptyTemplate: "Á©∫„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                exportCurrentData: "ÁèæÂú®„ÅÆ„Éá„Éº„Çø„Çí„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                exportHTML: "HTML„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                emptyTemplateExported: "Á©∫„ÅÆ„ÉÜ„É≥„Éó„É¨„Éº„Éà \\\"{{filename}}\\\" „ÅåÊ≠£Â∏∏„Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åï„Çå„Åæ„Åó„Åü„ÄÇ",
                currentDataExported: "ÁèæÂú®„ÅÆ„Éá„Éº„Çø \\\"{{filename}}\\\" „ÅåÊ≠£Â∏∏„Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åï„Çå„Åæ„Åó„Åü„ÄÇ",
                htmlExported: "„Çπ„Çø„É≥„Éâ„Ç¢„É≠„É≥HTML \\\"{{filename}}\\\" „ÅåÊ≠£Â∏∏„Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Åï„Çå„Åæ„Åó„Åü„ÄÇ",
                pngExportRequiresLib: "PNG„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Å´„ÅØhtml2canvas„É©„Ç§„Éñ„É©„É™„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ<br>‰ª£„Çè„Çä„Å´SVG„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Çí„ÅîÂà©Áî®„Åè„Å†„Åï„ÅÑ„ÄÇ",
                selectColor: "{{field}}„ÇíÈÅ∏Êäû",
                departmentPresets: "ÈÉ®ÈñÄ„Éó„É™„Çª„ÉÉ„Éà",
                colorPalette: "„Ç´„É©„Éº„Éë„É¨„ÉÉ„Éà",
                customColor: "„Ç´„Çπ„Çø„É†Ëâ≤",
                apply: "ÈÅ©Áî®",
                clearColor: "Ëâ≤„Çí„ÇØ„É™„Ç¢Ôºà„Éá„Éï„Ç©„É´„Éà‰ΩøÁî®Ôºâ",
                callNameLegend: "Call Name - Ê≠£ÂºèÂêçÁß∞ÂØæÁÖß",
                colorLegend: "Ëâ≤ÂàÜ„ÅëË°®Á§∫",
                customColorUsage: "„Ç´„Çπ„Çø„É†Ëâ≤: {{count}}ÁµÑÁπî„ÄÅ{{patterns}}„Éë„Çø„Éº„É≥",
                organizationOnly: "ÁµÑÁπî„ÅÆ„Åø",
                dataOperations: "üìÅ „Éá„Éº„ÇøÊìç‰Ωú",
                dataEditingValidation: "üõ†Ô∏è „Éá„Éº„ÇøÁ∑®ÈõÜ„ÉªÊ§úË®º",
                chartGeneration: "üéØ ÁµÑÁπîÂõ≥ÁîüÊàê",
                exportOutput: "üì§ „Ç®„ÇØ„Çπ„Éù„Éº„Éà„ÉªÂá∫Âäõ",
                displayControl: "üñ•Ô∏è Ë°®Á§∫Âà∂Âæ°",
                
                // Detailed Instructions
                detailedUsageTitle: "Ë©≥Á¥∞„Å™‰ΩøÁî®ÊñπÊ≥ï",
                showDetailedInstructions: "Ë©≥Á¥∞„Å™‰ΩøÁî®ÊñπÊ≥ï„ÇíË°®Á§∫",
                hideInstructions: "‰ΩøÁî®ÊñπÊ≥ï„ÇíÈùûË°®Á§∫",
                
                step1Title: "1Ô∏è‚É£ „Éá„Éº„ÇøÂÖ•Âäõ",
                step1Item1: "Excel„Éï„Ç°„Ç§„É´Ôºà.xlsx, .xlsÔºâ„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åæ„Åü„ÅØ„Çµ„É≥„Éó„É´„Éá„Éº„Çø„Çí‰ΩøÁî®",
                step1Item2: "„Éï„Ç°„Ç§„É´„ÇíÁõ¥Êé•„Éâ„É≠„ÉÉ„Éó„Çæ„Éº„É≥„Å´„Éâ„É©„ÉÉ„Ç∞&„Éâ„É≠„ÉÉ„Éó",
                step1Item3: "„Äå„Çµ„É≥„Éó„É´„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Äç„Åß„Éá„É¢„Éá„Éº„ÇøÔºà500‰∫∫„ÅÆË£ΩÈÄ†‰ºöÁ§æÔºâ„ÇíË©¶Áî®",
                
                step2Title: "2Ô∏è‚É£ „Éá„Éº„ÇøÊ§úË®º",
                step2Item1: "„Äå„Éá„Éº„ÇøÊ§úË®º„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Ç®„É©„Éº„ÇÑ‰∏çÊï¥Âêà„Çí„ÉÅ„Çß„ÉÉ„ÇØ",
                step2Item2: "„Äå„Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´Ë°®Á§∫/Á∑®ÈõÜ„Äç„Åß„Éá„Éº„Çø„ÇíÁ¢∫Ë™ç„Éª‰øÆÊ≠£",
                step2Item3: "ÁµÑÁπîÂõ≥ÁîüÊàêÂâç„Å´Ê§úË®º„Ç®„É©„Éº„Çí‰øÆÊ≠£",
                
                step3Title: "3Ô∏è‚É£ ÁµÑÁπîÂõ≥ÁîüÊàê",
                step3Item1: "Âü∫Ê∫ñÁµÑÁπî„ÇíÈÅ∏ÊäûÔºà‰ªªÊÑè - Á©∫ÁôΩ„ÅßÂÖ®‰ΩìË°®Á§∫Ôºâ",
                step3Item2: "„É¨„Éô„É´Âà∂Èôê„ÅßÁµÑÁπîÂõ≥„ÅÆÊ∑±„Åï„ÇíÂà∂Âæ°",
                step3Item3: "„ÄåÁÆ°ÁêÜËÄÖ„ÇíÈùûË°®Á§∫„Äç„ÅßÁµÑÁπîÊßãÈÄ†„ÅÆ„Åø„ÇíË°®Á§∫",
                step3Item4: "„Éï„Ç©„É≥„Éà„Çµ„Ç§„Ç∫„Å®„Éú„ÉÉ„ÇØ„Çπ„Çµ„Ç§„Ç∫„ÇíÊúÄÈÅ©Ë°®Á§∫„Å´Ë™øÊï¥",
                step3Item5: "„ÄåÁµÑÁπîÂõ≥ÁîüÊàê„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÂèØË¶ñÂåñ„Çí‰ΩúÊàê",
                
                step4Title: "4Ô∏è‚É£ „Ç®„ÇØ„Çπ„Éù„Éº„Éà„ÉªÂá∫Âäõ",
                step4Item1: "„Çπ„Ç±„Éº„É©„Éñ„É´„Éô„ÇØ„Çø„Éº„Ç∞„É©„Éï„Ç£„ÉÉ„ÇØ„Çπ„Å®„Åó„Å¶SVG„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                step4Item2: "„É©„Çπ„Çø„ÉºÁîªÂÉè„Å®„Åó„Å¶PNG„Ç®„ÇØ„Çπ„Éù„Éº„ÉàÔºàhtml2canvas„ÅåÂøÖË¶ÅÔºâ",
                step4Item3: "„Éñ„É©„Ç¶„Ç∂„Åã„ÇâÁõ¥Êé•Âç∞Âà∑",
                step4Item4: "„Çà„ÇäËâØ„ÅÑË°®Á§∫„ÅÆ„Åü„ÇÅ„ÅÆ„Éï„É´„Çπ„ÇØ„É™„Éº„É≥„É¢„Éº„Éâ",
                step4Item5: "ÁèæÂú®„ÅÆ„Éá„Éº„Çø„ÇíExcelÂΩ¢Âºè„Å´„Ç®„ÇØ„Çπ„Éù„Éº„Éà",
                
                validationTitle: "üìã „Éá„Éº„ÇøÊ§úË®º„ÉÅ„Çß„ÉÉ„ÇØÈ†ÖÁõÆ",
                validation1: "ÂøÖÈ†à„Éï„Ç£„Éº„É´„Éâ„ÉÅ„Çß„ÉÉ„ÇØÔºöÂêçÂâç„ÄÅCall Name„ÄÅÂΩπËÅ∑„ÅÆÂÖ•ÂäõÂøÖÈ†à",
                validation2: "Âæ™Áí∞ÂèÇÁÖßÊ§úÂá∫ÔºöÈöéÂ±§„ÅÆÁÑ°Èôê„É´„Éº„Éó„ÇíÈò≤Ê≠¢",
                validation3: "Â≠§Á´ãÁµÑÁπî„ÉÅ„Çß„ÉÉ„ÇØÔºöÁÑ°Âäπ„Å™Ë¶™ÁµÑÁπîÂèÇÁÖß„ÅÆÁ¢∫Ë™ç",
                validation4: "ÈáçË§áÊ§úÂá∫ÔºöÂêå‰∏ÄÁµÑÁπîÂÜÖ„ÅÆÂΩπËÅ∑Á´∂Âêà„ÇíÁ¢∫Ë™ç",
                validation5: "„É¨„Éô„É´Êï¥ÂêàÊÄßÔºöÈÅ©Âàá„Å™ÈöéÂ±§„É¨„Éô„É´È†ÜÂ∫è„ÅÆÁ¢∫Ë™ç",
                validation6: "„ÉÅ„Éº„É†„Éú„ÇπÊ§úË®ºÔºöÁµÑÁπî„ÅÇ„Åü„Çä1Âêç„ÅÆ„ÉÅ„Éº„É†„Éú„Çπ„ÇíÁ¢∫‰øù",
                validation7: "Ëâ≤ÂΩ¢ÂºèÊ§úË®ºÔºö„Ç´„Çπ„Çø„É†Ëâ≤ÂÄ§ÔºàHEX„ÄÅRGB„ÄÅËâ≤ÂêçÔºâ„ÅÆÁ¢∫Ë™ç",
                validation8: "ÂΩπËÅ∑ÁµÑ„ÅøÂêà„Çè„ÅõÊ§úË®ºÔºöÁÆ°ÁêÜËÄÖ/„Ç¢„Éâ„Éê„Ç§„Ç∂„ÅÆÁµÑ„ÅøÂêà„Çè„ÅõÁ¢∫Ë™ç",
                validation9: "„Éá„Éº„ÇøÂûãÊ§úË®ºÔºöÂêÑ„Éï„Ç£„Éº„É´„Éâ„ÅÆÈÅ©Âàá„Å™„Éá„Éº„ÇøÂûãÁ¢∫Ë™ç",
                validation10: "ÈöéÂ±§Ê∑±Â∫¶„ÉÅ„Çß„ÉÉ„ÇØÔºöÂêàÁêÜÁöÑ„Å™ÁµÑÁπîÊ∑±Â∫¶„ÅÆÁ¢∫Ë™ç",
                
                featuresTitle: "üåü ‰∏ªË¶ÅÊ©üËÉΩ",
                feature1: "Â§öË®ÄË™ûÂØæÂøúÔºöËã±Ë™û„ÄÅÊó•Êú¨Ë™û„ÄÅ„Ç§„É≥„Éâ„Éç„Ç∑„Ç¢Ë™û",
                feature2: "Ëá™ÂãïË®ÄË™ûÊ§úÂá∫„Å®Ë®≠ÂÆö‰øùÊåÅ",
                feature3: "„Éë„É¨„ÉÉ„Éà„Å®„Éó„É™„Çª„ÉÉ„Éà‰ªò„Åç„Ç´„Çπ„Çø„É†Ëâ≤„Ç∑„Çπ„ÉÜ„É†",
                feature4: "Êßò„ÄÖ„Å™ÁîªÈù¢„Çµ„Ç§„Ç∫„Å´ÂØæÂøú„Åô„Çã„É¨„Çπ„Éù„É≥„Ç∑„Éñ„Éá„Ç∂„Ç§„É≥",
                feature5: "„É™„Ç¢„É´„Çø„Ç§„É†„Éá„Éº„ÇøÊ§úË®º„Å®„Ç®„É©„ÉºÂ†±Âëä",
                feature6: "ÊüîËªü„Å™ÁµÑÁπîÈöéÂ±§Ë°®Á§∫",
                feature7: "„Éó„É≠„Éï„Çß„ÉÉ„Ç∑„Éß„Éä„É´„Å™„Ç®„ÇØ„Çπ„Éù„Éº„Éà„Ç™„Éó„Ç∑„Éß„É≥ÔºàSVG„ÄÅPNG„ÄÅHTMLÔºâ",
                feature8: "„ÉÅ„Éº„É†„Éú„Çπ„Å®„Ç¢„Éâ„Éê„Ç§„Ç∂ÂΩπËÅ∑ÁÆ°ÁêÜ"
            },
            id: {
                languageLabel: "Bahasa:",
                title: "Alat Bagan Organisasi",
                subtitle: "Otomatis membuat bagan organisasi dari file Excel",
                usage: "Penggunaan: 1Ô∏è‚É£ Pilih file ‚Üí 2Ô∏è‚É£ Validasi data ‚Üí 3Ô∏è‚É£ Buat bagan ‚Üí 4Ô∏è‚É£ Ekspor",
                demoMode: "Mode Demo: Berjalan dengan data sampel",
                fileDropZone: "üìÅ Seret file Excel di sini atau klik untuk memilih",
                supportedFormats: "Format yang didukung: .xlsx, .xls",
                baseOrganization: "Organisasi Dasar:",
                showAll: "Tampilkan Semua",
                levelLimit: "Batas Level:",
                noLimit: "Tanpa Batas",
                levelsUpTo: "Hingga {{n}} level",
                fontSize: "Ukuran Font:",
                boxSize: "Ukuran Kotak:",
                hideManagers: "Sembunyikan Manajer",
                small: "Kecil",
                medium: "Sedang",
                large: "Besar",
                generateChart: "Buat Bagan",
                showDataTable: "Tampilkan/Edit Tabel Data",
                validateData: "Validasi Data",
                exportSVG: "Ekspor SVG",
                exportPNG: "Ekspor PNG",
                print: "Cetak",
                fullScreen: "Layar Penuh",
                exitFullScreen: "Keluar Layar Penuh",
                loadSampleData: "Muat Data Sampel",
                dataTableTitle: "Tabel Data - Validasi & Edit",
                addNewRow: "Tambah Baris Baru",
                applyChanges: "Terapkan Perubahan",
                closeTable: "Tutup Tabel",
                tableHeaders: {
                    actions: "Aksi",
                    level: "Level",
                    employeeId: "ID Karyawan",
                    name: "Nama",
                    nameEn: "Nama (EN)",
                    grade: "Grade",
                    teamLongName: "Nama Lengkap Tim",
                    callName: "Call Name",
                    concurrent: "Rangkap Jabatan",
                    parent: "Organisasi Induk",
                    role: "Peran",
                    roleJp: "Peran (JP)",
                    borderColor: "Warna Borderüé®",
                    backgroundColor: "Warna Latar Headerüé®",
                    headerTextColor: "Warna Teks Headerüé®",
                    status: "Status"
                },
                valid: "OK",
                invalid: "Error",
                warning: "Peringatan",
                pending: "Menunggu",
                delete: "Hapus",
                selectPlease: "Silakan pilih",
                success: "Berhasil!",
                error: "Error",
                noDataLoaded: "Tidak ada data yang dimuat. Silakan pilih file Excel terlebih dahulu.",
                fileLoadComplete: 'File "{{filename}}" berhasil dimuat.',
                chartGenerated: "Bagan dibuat ({{count}} organisasi)",
                changesApplied: "Perubahan berhasil diterapkan\\n{{count}} baris data diterapkan (Warna kustom: {{customColors}} organisasi)\\n\\nKlik 'Buat Bagan' untuk melihat bagan yang diperbarui.",
                nameRequired: "Nama wajib diisi",
                callNameRequired: "Call Name wajib diisi",
                roleRequired: "Peran wajib diisi",
                levelOutOfRange: "Level harus antara 1-10",
                parentNotFound: "Organisasi induk (Call Name) tidak ditemukan",
                circularReference: "Referensi melingkar terdeteksi",
                invalidColorFormat: "Format {{field}} tidak valid: {{value}}",
                colorValidationError: "Error validasi {{field}}: {{error}}",
                exportStarted: "Unduhan dimulai",
                exportEmptyTemplate: "Ekspor Template Kosong",
                exportCurrentData: "Ekspor Data Saat Ini",
                exportHTML: "Ekspor HTML",
                emptyTemplateExported: "Template kosong \\\"{{filename}}\\\" berhasil diekspor.",
                currentDataExported: "Data saat ini \\\"{{filename}}\\\" berhasil diekspor.",
                htmlExported: "HTML mandiri \\\"{{filename}}\\\" berhasil diekspor.",
                pngExportRequiresLib: "Ekspor PNG memerlukan library html2canvas.<br>Silakan gunakan ekspor SVG sebagai gantinya.",
                selectColor: "Pilih {{field}}",
                departmentPresets: "Preset Departemen",
                colorPalette: "Palet Warna",
                customColor: "Warna Kustom",
                apply: "Terapkan",
                clearColor: "Hapus Warna (Gunakan Default)",
                callNameLegend: "Call Name - Referensi Nama Lengkap",
                colorLegend: "Kode Warna",
                customColorUsage: "Warna kustom: {{count}} organisasi, {{patterns}} pola",
                organizationOnly: "Hanya Organisasi",
                dataOperations: "üìÅ Operasi Data",
                dataEditingValidation: "üõ†Ô∏è Edit & Validasi Data",
                chartGeneration: "üéØ Pembuatan Bagan",
                exportOutput: "üì§ Ekspor & Output",
                displayControl: "üñ•Ô∏è Kontrol Tampilan",
                
                // Detailed Instructions
                detailedUsageTitle: "Petunjuk Penggunaan Terperinci",
                showDetailedInstructions: "Tampilkan Petunjuk Terperinci",
                hideInstructions: "Sembunyikan Petunjuk",
                
                step1Title: "1Ô∏è‚É£ Input Data",
                step1Item1: "Upload file Excel (.xlsx, .xls) atau gunakan data sampel",
                step1Item2: "Drag dan drop file langsung ke zona drop",
                step1Item3: "Gunakan \"Muat Data Sampel\" untuk mencoba data demo (perusahaan manufaktur 500 orang)",
                
                step2Title: "2Ô∏è‚É£ Validasi Data",
                step2Item1: "Klik \"Validasi Data\" untuk memeriksa kesalahan dan ketidakkonsistenan",
                step2Item2: "Gunakan \"Tampilkan/Edit Tabel Data\" untuk meninjau dan memodifikasi data",
                step2Item3: "Perbaiki kesalahan validasi sebelum membuat bagan",
                
                step3Title: "3Ô∏è‚É£ Pembuatan Bagan",
                step3Item1: "Pilih organisasi dasar (opsional - kosongkan untuk bagan lengkap)",
                step3Item2: "Atur batas level untuk mengontrol kedalaman bagan",
                step3Item3: "Toggle \"Sembunyikan Manajer\" untuk menampilkan struktur organisasi saja",
                step3Item4: "Sesuaikan ukuran font dan kotak untuk tampilan optimal",
                step3Item5: "Klik \"Buat Bagan\" untuk membuat visualisasi",
                
                step4Title: "4Ô∏è‚É£ Ekspor & Output",
                step4Item1: "Ekspor sebagai SVG untuk grafik vektor yang dapat diskalakan",
                step4Item2: "Ekspor sebagai PNG untuk gambar raster (memerlukan html2canvas)",
                step4Item3: "Cetak langsung dari browser",
                step4Item4: "Gunakan mode Layar Penuh untuk tampilan yang lebih baik",
                step4Item5: "Ekspor data saat ini kembali ke format Excel",
                
                validationTitle: "üìã Pemeriksaan Validasi Data",
                validation1: "Pemeriksaan field wajib: Nama, Call Name, dan Peran harus diisi",
                validation2: "Deteksi referensi melingkar: Mencegah loop tak terbatas dalam hierarki",
                validation3: "Organisasi yatim: Memeriksa referensi organisasi induk yang tidak valid",
                validation4: "Deteksi duplikat: Memastikan tidak ada konflik peran dalam organisasi yang sama",
                validation5: "Konsistensi level: Memverifikasi urutan level hierarki yang tepat",
                validation6: "Validasi team boss: Memastikan hanya satu team boss per organisasi",
                validation7: "Validasi format warna: Memeriksa nilai warna kustom (HEX, RGB, nama warna)",
                validation8: "Validasi kombinasi peran: Memvalidasi kombinasi manajer/advisor",
                validation9: "Validasi tipe data: Memastikan tipe data yang tepat untuk setiap field",
                validation10: "Pemeriksaan kedalaman hierarki: Memvalidasi kedalaman organisasi yang wajar",
                
                featuresTitle: "üåü Fitur Utama",
                feature1: "Dukungan multi-bahasa: Inggris, Jepang, Indonesia",
                feature2: "Deteksi bahasa otomatis dan persistensi",
                feature3: "Sistem warna kustom dengan palet dan preset",
                feature4: "Desain responsif untuk berbagai ukuran layar",
                feature5: "Validasi data real-time dan laporan kesalahan",
                feature6: "Tampilan hierarki organisasi yang fleksibel",
                feature7: "Opsi ekspor profesional (SVG, PNG, HTML)",
                feature8: "Manajemen peran team boss dan advisor"
            }
        };

        // Current language setting - dynamically changeable
        let CURRENT_LANG = localStorage.getItem('organizationChartLang') || 'en'; // Default to English

        // Available languages
        const AVAILABLE_LANGUAGES = {
            'en': 'English',
            'ja': 'Êó•Êú¨Ë™û', 
            'id': 'Bahasa Indonesia'
        };

        // Helper function to get translated text
        function t(key, params = {}) {
            const keys = key.split('.');
            let value = LANG[CURRENT_LANG];
            
            for (const k of keys) {
                value = value?.[k];
                if (!value) break;
            }
            
            if (typeof value === 'string') {
                // Replace parameters like {{n}}, {{filename}}, etc.
                return value.replace(/\\{\\{(\\w+)\\}\\}/g, (match, param) => params[param] || match);
            }
            
            return key; // Return key if translation not found
        }

        // Language management functions
        const LanguageManager = {
            getCurrentLanguage() {
                return CURRENT_LANG;
            },
            
            setLanguage(langCode) {
                if (LANG[langCode]) {
                    CURRENT_LANG = langCode;
                    localStorage.setItem('organizationChartLang', langCode);
                    this.updatePageContent();
                    console.log(`Language changed to: ${langCode}`);
                } else {
                    console.error(`Language not supported: ${langCode}`);
                }
            },
            
            getAvailableLanguages() {
                return AVAILABLE_LANGUAGES;
            },
            
            updatePageContent() {
                document.title = t('title');
                
                document.querySelectorAll('[data-i18n]').forEach(element => {
                    const key = element.getAttribute('data-i18n');
                    const paramsAttr = element.getAttribute('data-i18n-params');
                    let params = {};
                    
                    if (paramsAttr) {
                        try {
                            params = JSON.parse(paramsAttr);
                        } catch (e) {
                            console.warn('Invalid data-i18n-params JSON:', paramsAttr);
                        }
                    }
                    
                    const translated = t(key, params);
                    
                    if (element.tagName === 'INPUT' && (element.type === 'button' || element.type === 'submit')) {
                        element.value = translated;
                    } else if (element.tagName === 'INPUT' && element.placeholder !== undefined) {
                        element.placeholder = translated;
                    } else {
                        element.textContent = translated;
                    }
                });
                
                document.querySelectorAll('[data-i18n-html]').forEach(element => {
                    const key = element.getAttribute('data-i18n-html');
                    const paramsAttr = element.getAttribute('data-i18n-params');
                    let params = {};
                    
                    if (paramsAttr) {
                        try {
                            params = JSON.parse(paramsAttr);
                        } catch (e) {
                            console.warn('Invalid data-i18n-params JSON for HTML element:', paramsAttr);
                        }
                    }
                    
                    element.innerHTML = t(key, params);
                });
                
                const languageSelect = document.getElementById('languageSelect');
                if (languageSelect) {
                    languageSelect.value = CURRENT_LANG;
                }
                
                document.dispatchEvent(new CustomEvent('languageChanged', { 
                    detail: { language: CURRENT_LANG } 
                }));
            },
            
            initialize() {
                this.createLanguageSelector();
                this.updatePageContent();
                console.log('Language system initialized with: ' + CURRENT_LANG);
            },
            
            createLanguageSelector() {
                const headerTop = document.querySelector('.header-top') || document.querySelector('.header') || document.querySelector('.controls') || document.body;
                
                if (document.getElementById('languageSelector')) {
                    return;
                }
                
                const selectorContainer = document.createElement('div');
                selectorContainer.id = 'languageSelector';
                selectorContainer.className = 'language-selector';
                selectorContainer.style.cssText = `
                    display: flex;
                    align-items: center;
                    gap: 8px;
                `;
                
                const label = document.createElement('label');
                label.setAttribute('data-i18n', 'languageLabel');
                label.textContent = t('languageLabel');
                label.style.cssText = `
                    margin: 0;
                    font-size: 14px;
                    font-weight: 600;
                    color: #4a5568;
                `;
                
                const select = document.createElement('select');
                select.id = 'languageSelect';
                select.style.cssText = `
                    font-size: 13px;
                    padding: 4px 8px;
                    border-radius: 4px;
                    border: 1px solid #cbd5e0;
                    background: white;
                    cursor: pointer;
                `;
                
                Object.entries(AVAILABLE_LANGUAGES).forEach(([code, name]) => {
                    const option = document.createElement('option');
                    option.value = code;
                    option.textContent = name;
                    if (code === CURRENT_LANG) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });
                
                select.addEventListener('change', (e) => {
                    this.setLanguage(e.target.value);
                });
                
                selectorContainer.appendChild(label);
                selectorContainer.appendChild(select);
                
                if (headerTop.classList.contains('header-top')) {
                    headerTop.appendChild(selectorContainer);
                } else {
                    if (headerTop.firstChild) {
                        headerTop.insertBefore(selectorContainer, headerTop.firstChild);
                    } else {
                        headerTop.appendChild(selectorContainer);
                    }
                }
            }
        };

        // Sample data (500-person Manufacturing Company - Western style)
        const CORRECTED_SAMPLE_DATA = [
            [1, "001", "Robert Johnson", "Robert Johnson", "CEO", "HQ001", "Global Manufacturing Corp", "Global MFG", "N/A", "Chief Executive Officer", "ÊúÄÈ´òÁµåÂñ∂Ë≤¨‰ªªËÄÖ", "#2196f3", "#e3f2fd", "#000000", "Y", ""],
            [2, "002", "Sarah Williams", "Sarah Williams", "COO", "OPS001", "Operations Division", "Operations", "Global MFG", "Chief Operating Officer", "ÊúÄÈ´òÂü∑Ë°åË≤¨‰ªªËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [2, "003", "Michael Chen", "Michael Chen", "CFO", "FIN001", "Finance Division", "Finance", "Global MFG", "Chief Financial Officer", "ÊúÄÈ´òË≤°ÂãôË≤¨‰ªªËÄÖ", "#ff9800", "#fff3e0", "#000000", "Y", ""],
            [2, "004", "Jennifer Davis", "Jennifer Davis", "CHRO", "HR001", "Human Resources Division", "HR", "Global MFG", "Chief Human Resources Officer", "ÊúÄÈ´ò‰∫∫‰∫ãË≤¨‰ªªËÄÖ", "#9c27b0", "#f3e5f5", "#000000", "Y", ""],
            [2, "005", "David Miller", "David Miller", "CTO", "IT001", "Technology Division", "IT", "Global MFG", "Chief Technology Officer", "ÊúÄÈ´òÊäÄË°ìË≤¨‰ªªËÄÖ", "#f44336", "#ffebee", "#000000", "Y", ""],
            [3, "006", "Amanda Rodriguez", "Amanda Rodriguez", "VP", "MFG001", "Manufacturing Operations", "Manufacturing", "Operations", "Vice President Manufacturing", "Ë£ΩÈÄ†ÊãÖÂΩìÂâØÁ§æÈï∑", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [3, "007", "James Thompson", "James Thompson", "VP", "QA001", "Quality Assurance", "Quality", "Operations", "Vice President Quality", "ÂìÅË≥™ÊãÖÂΩìÂâØÁ§æÈï∑", "#2196f3", "#e3f2fd", "#000000", "Y", ""],
            [3, "008", "Lisa Anderson", "Lisa Anderson", "VP", "SCM001", "Supply Chain Management", "Supply Chain", "Operations", "Vice President Supply Chain", "„Çµ„Éó„É©„Ç§„ÉÅ„Çß„Éº„É≥ÊãÖÂΩìÂâØÁ§æÈï∑", "#ff9800", "#fff3e0", "#000000", "Y", ""],
            [3, "009", "Thomas Wilson", "Thomas Wilson", "VP", "ENG001", "Engineering", "Engineering", "Operations", "Vice President Engineering", "„Ç®„É≥„Ç∏„Éã„Ç¢„É™„É≥„Ç∞ÊãÖÂΩìÂâØÁ§æÈï∑", "#9c27b0", "#f3e5f5", "#000000", "Y", ""],
            [3, "010", "Emily Brown", "Emily Brown", "VP", "SAL001", "Sales & Marketing", "Sales", "Global MFG", "Vice President Sales", "Âñ∂Ê•≠ÊãÖÂΩìÂâØÁ§æÈï∑", "#f44336", "#ffebee", "#000000", "Y", ""],
            [4, "011", "Christopher Lee", "Christopher Lee", "DIR", "PROD1", "Production Plant 1", "Plant 1", "Manufacturing", "Plant Director", "Â∑•Â†¥Èï∑", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [4, "012", "Maria Garcia", "Maria Garcia", "DIR", "PROD2", "Production Plant 2", "Plant 2", "Manufacturing", "Plant Director", "Â∑•Â†¥Èï∑", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [4, "013", "Kevin White", "Kevin White", "DIR", "PROD3", "Production Plant 3", "Plant 3", "Manufacturing", "Plant Director", "Â∑•Â†¥Èï∑", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [4, "014", "Rachel Martin", "Rachel Martin", "DIR", "QC001", "Quality Control", "QC", "Quality", "Quality Director", "ÂìÅË≥™ÁÆ°ÁêÜÈÉ®Èï∑", "#2196f3", "#e3f2fd", "#000000", "Y", ""],
            [4, "015", "Daniel Taylor", "Daniel Taylor", "DIR", "R&D001", "Research & Development", "R&D", "Engineering", "R&D Director", "Á†îÁ©∂ÈñãÁô∫ÈÉ®Èï∑", "#9c27b0", "#f3e5f5", "#000000", "Y", ""],
            [4, "016", "Jessica Moore", "Jessica Moore", "DIR", "PROC001", "Procurement", "Procurement", "Supply Chain", "Procurement Director", "Ë™øÈÅîÈÉ®Èï∑", "#ff9800", "#fff3e0", "#000000", "Y", ""],
            [4, "017", "Paul Jackson", "Paul Jackson", "DIR", "LOG001", "Logistics", "Logistics", "Supply Chain", "Logistics Director", "Áâ©ÊµÅÈÉ®Èï∑", "#ff9800", "#fff3e0", "#000000", "Y", ""],
            [4, "018", "Laura Adams", "Laura Adams", "DIR", "MKTG001", "Marketing", "Marketing", "Sales", "Marketing Director", "„Éû„Éº„Ç±„ÉÜ„Ç£„É≥„Ç∞ÈÉ®Èï∑", "#f44336", "#ffebee", "#000000", "Y", ""],
            [4, "019", "Brian Clark", "Brian Clark", "DIR", "SALES1", "Regional Sales North", "Sales North", "Sales", "Sales Director", "Âñ∂Ê•≠ÈÉ®Èï∑", "#f44336", "#ffebee", "#000000", "Y", ""],
            [4, "020", "Nicole Lewis", "Nicole Lewis", "DIR", "SALES2", "Regional Sales South", "Sales South", "Sales", "Sales Director", "Âñ∂Ê•≠ÈÉ®Èï∑", "#f44336", "#ffebee", "#000000", "Y", ""],
            [5, "021", "Andrew Hall", "Andrew Hall", "MGR", "ASM001", "Assembly Line 1", "Assembly 1", "Plant 1", "Assembly Manager", "ÁµÑÁ´ãÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "022", "Michelle Young", "Michelle Young", "MGR", "ASM002", "Assembly Line 2", "Assembly 2", "Plant 1", "Assembly Manager", "ÁµÑÁ´ãÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "023", "Steven King", "Steven King", "MGR", "MCH001", "Machining Department", "Machining", "Plant 1", "Machining Manager", "Ê©üÊ¢∞Âä†Â∑•ÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "024", "Rebecca Wright", "Rebecca Wright", "MGR", "WLD001", "Welding Department", "Welding", "Plant 2", "Welding Manager", "Ê∫∂Êé•ÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "025", "John Scott", "John Scott", "MGR", "FIN001", "Finishing Department", "Finishing", "Plant 2", "Finishing Manager", "‰ªï‰∏ä„ÅíÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "026", "Karen Green", "Karen Green", "MGR", "PKG001", "Packaging Department", "Packaging", "Plant 3", "Packaging Manager", "ÂåÖË£ÖÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "027", "Robert Turner", "Robert Turner", "MGR", "SHP001", "Shipping Department", "Shipping", "Plant 3", "Shipping Manager", "Âá∫Ëç∑ÁÆ°ÁêÜËÄÖ", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [5, "028", "Amy Phillips", "Amy Phillips", "MGR", "QCLAB", "QC Laboratory", "QC Lab", "QC", "Lab Manager", "Ê§úÊüªÂÆ§ÁÆ°ÁêÜËÄÖ", "#2196f3", "#e3f2fd", "#000000", "Y", ""],
            [5, "029", "Mark Campbell", "Mark Campbell", "MGR", "QCFLD", "Field Quality Control", "QC Field", "QC", "Field QC Manager", "ÁèæÂ†¥ÂìÅË≥™ÁÆ°ÁêÜËÄÖ", "#2196f3", "#e3f2fd", "#000000", "Y", ""],
            [5, "030", "Stephanie Parker", "Stephanie Parker", "MGR", "PRDDEV", "Product Development", "Product Dev", "R&D", "Product Development Manager", "Ë£ΩÂìÅÈñãÁô∫ÁÆ°ÁêÜËÄÖ", "#9c27b0", "#f3e5f5", "#000000", "Y", ""],
            [6, "031", "Ryan Evans", "Ryan Evans", "SUP", "ASM1A", "Assembly Team A", "Asm Team A", "Assembly 1", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "032", "Crystal Collins", "Crystal Collins", "SUP", "ASM1B", "Assembly Team B", "Asm Team B", "Assembly 1", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "033", "Gregory Stewart", "Gregory Stewart", "SUP", "ASM2A", "Assembly Team C", "Asm Team C", "Assembly 2", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "034", "Heather Morris", "Heather Morris", "SUP", "MCH1A", "Machining Team A", "Mach Team A", "Machining", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "035", "Brandon Rogers", "Brandon Rogers", "SUP", "MCH1B", "Machining Team B", "Mach Team B", "Machining", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "036", "Vanessa Reed", "Vanessa Reed", "SUP", "WLD1A", "Welding Team A", "Weld Team A", "Welding", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "037", "Eric Cook", "Eric Cook", "SUP", "WLD1B", "Welding Team B", "Weld Team B", "Welding", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "038", "Diana Bailey", "Diana Bailey", "SUP", "FIN1A", "Finishing Team A", "Fin Team A", "Finishing", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "039", "Justin Rivera", "Justin Rivera", "SUP", "PKG1A", "Packaging Team A", "Pkg Team A", "Packaging", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""],
            [6, "040", "Samantha Cooper", "Samantha Cooper", "SUP", "SHP1A", "Shipping Team A", "Ship Team A", "Shipping", "Team Supervisor", "„ÉÅ„Éº„É†„É™„Éº„ÉÄ„Éº", "#4caf50", "#f1f8e9", "#000000", "Y", ""]
        ];

        // Application configuration
        const CONFIG = {
            DEFAULTS: {
                SPACING: { x: 72, y: 140 },
                BOX_SIZE: { width: 85, height: 100 },
                FONT_SIZES: {
                    small: { org: '10px', name: '8px', role: '7px' },
                    medium: { org: '12px', name: '10px', role: '9px' },
                    large: { org: '14px', name: '12px', role: '11px' }
                },
                BOX_SIZES: {
                    small: { width: '70px', height: '80px', spacingX: '57px', spacingY: '120px' },
                    medium: { width: '85px', height: '100px', spacingX: '72px', spacingY: '140px' },
                    large: { width: '100px', height: '120px', spacingX: '87px', spacingY: '170px' }
                }
            },
            DATA_PROCESSING: {
                REQUIRED_FIELDS: ['name', 'callName', 'role'],
                MANAGER_KEYWORDS: ['Èï∑', 'Manager', 'manager', 'Head', 'Chief', 'President', 'Factory manager', 'Department Manager', 'Section Manager'],
                ADVISOR_KEYWORDS: ['„Ç¢„Éâ„Éê„Ç§„Ç∂', 'Advisor', 'advisor']
            },
            LAYOUT: {
                MIN_SPACING: 30,
                VERTICAL_SPACING: 140,
                HORIZONTAL_SPACING: 72,
                MARGIN: 50,
                CONNECTION_LINE_OFFSET: 20
            },
            COLOR_SYSTEM: {
                DEFAULT_COLORS: {
                    borderColor: '#333',
                    backgroundColor: '#f9f9f9',
                    headerBackgroundColor: '#4a5568',
                    headerTextColor: '#ffffff'
                },
                PALETTE_COLORS: {
                    'blue-light': { hex: '#e3f2fd', name: 'ËñÑÈùí', category: 'blue' },
                    'blue-medium': { hex: '#2196f3', name: 'Èùí', category: 'blue' },
                    'blue-dark': { hex: '#1565c0', name: 'ÊøÉÈùí', category: 'blue' },
                    'green-light': { hex: '#f1f8e9', name: 'ËñÑÁ∑ë', category: 'green' },
                    'green-medium': { hex: '#4caf50', name: 'Á∑ë', category: 'green' },
                    'green-dark': { hex: '#2e7d32', name: 'ÊøÉÁ∑ë', category: 'green' },
                    'purple-light': { hex: '#f3e5f5', name: 'ËñÑÁ¥´', category: 'purple' },
                    'purple-medium': { hex: '#9c27b0', name: 'Á¥´', category: 'purple' },
                    'purple-dark': { hex: '#6a1b9a', name: 'ÊøÉÁ¥´', category: 'purple' },
                    'orange-light': { hex: '#fff3e0', name: 'ËñÑÊ©ô', category: 'orange' },
                    'orange-medium': { hex: '#ff9800', name: 'Ê©ô', category: 'orange' },
                    'orange-dark': { hex: '#e65100', name: 'ÊøÉÊ©ô', category: 'orange' },
                    'red-light': { hex: '#ffebee', name: 'ËñÑËµ§', category: 'red' },
                    'red-medium': { hex: '#f44336', name: 'Ëµ§', category: 'red' },
                    'red-dark': { hex: '#c62828', name: 'ÊøÉËµ§', category: 'red' }
                },
                COLOR_NAMES: {
                    'red': '#f44336', 'blue': '#2196f3', 'green': '#4caf50',
                    'orange': '#ff9800', 'purple': '#9c27b0', 'teal': '#009688',
                    'pink': '#e91e63', 'lime': '#cddc39', 'cyan': '#00bcd4',
                    'yellow': '#ffeb3b', 'brown': '#795548', 'gray': '#9e9e9e',
                    'black': '#000000', 'white': '#ffffff'
                }
            },
            EXPORT: {
                PNG_FILENAME: 'ÁµÑÁπîÂõ≥.png',
                SVG_FILENAME: 'ÁµÑÁπîÂõ≥.svg',
                PRINT_TITLE: 'ÁµÑÁπîÂõ≥Âç∞Âà∑'
            },
            DEBUG: {
                ENABLED: true,
                LOG_LAYOUT_CALCULATION: true,
                LOG_DATA_PROCESSING: true
            }
        };

        // Utility functions
        const ConfigUtils = {
            debugLog(message, category = 'general') {
                if (!CONFIG.DEBUG.ENABLED) return;
                
                const timestamp = new Date().toLocaleTimeString();
                console.log(`[${timestamp}] [${category.toUpperCase()}] ${message}`);
            },
            
            updateCSSVariables(variables) {
                const root = document.documentElement;
                Object.entries(variables).forEach(([key, value]) => {
                    root.style.setProperty(`--${key}`, value);
                });
            },
            
            get(path) {
                return path.split('.').reduce((obj, key) => obj && obj[key], CONFIG);
            },
            
            parseColorValue(colorValue) {
                if (!colorValue) return null;
                
                const value = colorValue.toString().trim();
                
                if (CONFIG.COLOR_SYSTEM.PALETTE_COLORS[value]) {
                    return CONFIG.COLOR_SYSTEM.PALETTE_COLORS[value].hex;
                }
                
                if (value.startsWith('#')) {
                    if (/^#[0-9a-f]{3}$/i.test(value)) {
                        const expanded = value.replace(/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i, '#$1$1$2$2$3$3');
                        return expanded;
                    }
                    if (/^#[0-9a-f]{6}$/i.test(value)) {
                        return value.toLowerCase();
                    }
                }
                
                if (value.startsWith('rgb')) {
                    return value;
                }
                
                const lowerValue = value.toLowerCase();
                if (CONFIG.COLOR_SYSTEM.COLOR_NAMES[lowerValue]) {
                    return CONFIG.COLOR_SYSTEM.COLOR_NAMES[lowerValue];
                }
                
                return null;
            }
        };

        // Global exports
        window.CONFIG = CONFIG;
        window.CORRECTED_SAMPLE_DATA = CORRECTED_SAMPLE_DATA;
        window.ConfigUtils = ConfigUtils;
        window.LANG = LANG;
        window.CURRENT_LANG = CURRENT_LANG;
        window.t = t;
        window.LanguageManager = LanguageManager;

        console.log('Organization Chart Tool - Standalone Version - Config Loaded');

        // === EMBEDDED JAVASCRIPT FROM DATA-PROCESSOR.JS ===
        
        /**
         * ÁµÑÁπîÂõ≥‰ΩúÊàê„ÉÑ„Éº„É´ - „Éá„Éº„ÇøÂá¶ÁêÜ„É¢„Ç∏„É•„Éº„É´ÔºàCall NameÂØæÂøúÁâà„Éª„Éá„Éº„ÇøÂèçÊò†‰øÆÊ≠£ÁâàÔºâ
         * Excel„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„ÄÅÂá¶ÁêÜ„ÄÅCall Name„ÉªÊ≠£ÂºèÂêçÁß∞„Éû„ÉÉ„Éî„É≥„Ç∞„ÇíÊãÖÂΩì
         */

        class DataProcessor {
            constructor() {
                this.rawData = [];
                this.processedData = {
                    organizations: new Map(),
                    hierarchy: new Map(),
                    managers: new Map(),
                    advisors: new Map()
                };
                this.callNameMapping = new Map();
                this.errors = [];
                this.isProcessed = false;
            }

            async processExcelFile(file) {
                try {
                    ConfigUtils.debugLog('Excel „Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„ÅøÈñãÂßã', 'data');
                    
                    const arrayBuffer = await file.arrayBuffer();
                    const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                    
                    const sheetNames = workbook.SheetNames;
                    if (sheetNames.length === 0) {
                        throw new Error('„ÉØ„Éº„ÇØ„Ç∑„Éº„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                    }
                    
                    const worksheet = workbook.Sheets[sheetNames[0]];
                    const data = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    if (data.length < 2) {
                        throw new Error('„Éá„Éº„Çø„Åå‰∏çË∂≥„Åó„Å¶„ÅÑ„Åæ„ÅôÔºà„Éò„ÉÉ„ÉÄ„ÉºË°å„ÇíÂê´„ÇÅ„Å¶2Ë°å‰ª•‰∏äÂøÖË¶ÅÔºâ');
                    }
                    
                    this.rawData = data.slice(1).filter(row => 
                        row && row.length > 0 && row.some(cell => cell !== null && cell !== undefined && cell !== '')
                    );
                    
                    ConfigUtils.debugLog(`Excel „Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÂÆå‰∫Ü: ${this.rawData.length}Ë°å`, 'data');
                    
                    this.processData();
                    
                } catch (error) {
                    ConfigUtils.debugLog(`Excel Âá¶ÁêÜ„Ç®„É©„Éº: ${error.message}`, 'error');
                    throw new Error(`Excel „Éï„Ç°„Ç§„É´„ÅÆÂá¶ÁêÜ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
                }
            }

            loadCorrectedSampleData() {
                try {
                    ConfigUtils.debugLog('‰øÆÊ≠£Ê∏à„Åø„Çµ„É≥„Éó„É´„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÈñãÂßã', 'data');
                    
                    this.rawData = CORRECTED_SAMPLE_DATA.map(row => [...row]);
                    
                    ConfigUtils.debugLog(`‰øÆÊ≠£Ê∏à„Åø„Çµ„É≥„Éó„É´„Éá„Éº„Çø: ${this.rawData.length}Ë°å`, 'data');
                    
                    this.processData();
                    
                } catch (error) {
                    ConfigUtils.debugLog(`‰øÆÊ≠£Ê∏à„Åø„Çµ„É≥„Éó„É´„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„Ç®„É©„Éº: ${error.message}`, 'error');
                    throw new Error(`‰øÆÊ≠£Ê∏à„Åø„Çµ„É≥„Éó„É´„Éá„Éº„Çø„ÅÆË™≠„ÅøËæº„Åø„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ${error.message}`);
                }
            }

            processData() {
                try {
                    ConfigUtils.debugLog('=== „Éá„Éº„ÇøÂá¶ÁêÜÈñãÂßãÔºàÂàùÊúüÂåñÂê´„ÇÄÔºâ===', 'data');
                    
                    this.processedData = {
                        organizations: new Map(),
                        hierarchy: new Map(),
                        managers: new Map(),
                        advisors: new Map(),
                        dataOrder: new Map()
                    };
                    this.callNameMapping.clear();
                    this.errors = [];
                    this.isProcessed = false;
                    
                    ConfigUtils.debugLog('Êó¢Â≠ò„Éá„Éº„Çø„ÇØ„É™„Ç¢ÂÆå‰∫Ü', 'data');
                    
                    if (!this.rawData || this.rawData.length === 0) {
                        throw new Error('Âá¶ÁêÜ„Åô„Çã„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì');
                    }
                    
                    ConfigUtils.debugLog(`Âá¶ÁêÜÂØæË±°„Éá„Éº„Çø: ${this.rawData.length}Ë°å`, 'data');
                    
                    this.cleanData();
                    this.buildCallNameMapping();
                    this.buildOrganizationData();
                    this.buildHierarchy();
                    this.processManagersAndAdvisors();
                    this.validateData();
                    
                    this.isProcessed = true;
                    
                    ConfigUtils.debugLog('=== „Éá„Éº„ÇøÂá¶ÁêÜÂÆå‰∫Ü ===', 'data');
                    ConfigUtils.debugLog(`ÁµÑÁπîÊï∞: ${this.processedData.organizations.size}`, 'data');
                    ConfigUtils.debugLog(`ÈöéÂ±§Èñ¢‰øÇ: ${this.processedData.hierarchy.size}`, 'data');
                    ConfigUtils.debugLog(`Call Name„Éû„ÉÉ„Éî„É≥„Ç∞: ${this.callNameMapping.size}`, 'data');
                    ConfigUtils.debugLog(`„Ç®„É©„ÉºÊï∞: ${this.errors.length}`, 'data');
                    
                } catch (error) {
                    ConfigUtils.debugLog(`„Éá„Éº„ÇøÂá¶ÁêÜ„Ç®„É©„Éº: ${error.message}`, 'error');
                    this.errors.push(`„Éá„Éº„ÇøÂá¶ÁêÜ„Ç®„É©„Éº: ${error.message}`);
                    throw error;
                }
            }

            cleanData() {
                ConfigUtils.debugLog('„Éá„Éº„Çø„ÇØ„É¨„É≥„Ç∏„É≥„Ç∞ÈñãÂßã', 'data');
                
                this.rawData = this.rawData.filter(row => {
                    const hasCallName = row[6] && row[6].toString().trim();
                    const hasName = row[2] && row[2].toString().trim();
                    
                    if (!hasCallName || !hasName) {
                        ConfigUtils.debugLog(`ÁÑ°Âäπ„Å™Ë°å„Çí„Çπ„Ç≠„ÉÉ„Éó: Call Name="${row[6]}", Name="${row[2]}"`, 'data');
                        return false;
                    }
                    
                    return true;
                });
                
                this.rawData.forEach((row, index) => {
                    for (let i = 0; i < row.length; i++) {
                        if (typeof row[i] === 'string') {
                            row[i] = row[i].trim();
                        }
                    }
                    
                    if (row[0]) {
                        row[0] = parseInt(row[0]) || 1;
                    } else {
                        row[0] = 1;
                    }
                    
                    if (row[8] === '' || row[8] === null || row[8] === undefined) {
                        row[8] = 'N/A';
                    }
                });
                
                ConfigUtils.debugLog(`„ÇØ„É¨„É≥„Ç∏„É≥„Ç∞Âæå„ÅÆ„Éá„Éº„ÇøÊï∞: ${this.rawData.length}Ë°å`, 'data');
            }

            buildCallNameMapping() {
                ConfigUtils.debugLog('Call Name „Éû„ÉÉ„Éî„É≥„Ç∞ÊßãÁØâÈñãÂßã', 'data');
                
                this.rawData.forEach(row => {
                    const callName = row[6];
                    const teamLongName = row[5];
                    
                    if (callName && teamLongName && callName !== teamLongName) {
                        this.callNameMapping.set(callName, teamLongName);
                        ConfigUtils.debugLog(`„Éû„ÉÉ„Éî„É≥„Ç∞ËøΩÂä†: ${callName} ‚Üí ${teamLongName}`, 'data');
                    }
                });
                
                ConfigUtils.debugLog(`Call Name „Éû„ÉÉ„Éî„É≥„Ç∞ÊßãÁØâÂÆå‰∫Ü: ${this.callNameMapping.size}‰ª∂`, 'data');
            }

            buildOrganizationData() {
                ConfigUtils.debugLog('ÁµÑÁπî„Éá„Éº„ÇøÊßãÁØâÈñãÂßã', 'data');
                
                this.rawData.forEach((row, index) => {
                    const callName = row[7];
                    const teamLongName = row[6] || callName;
                    const level = parseInt(row[0]) || 1;
                    const parent = row[8] === 'N/A' ? null : row[8];
                    
                    if (!this.processedData.organizations.has(callName)) {
                        const colorSettings = {
                            borderColor: row[11] || '',
                            backgroundColor: row[12] || '',
                            headerTextColor: row[13] || ''
                        };
                        
                        const colors = ConfigUtils.parseColorSettings ? ConfigUtils.parseColorSettings(colorSettings) : colorSettings;
                        
                        const orgData = {
                            name: callName,
                            longName: teamLongName,
                            level: level,
                            parent: parent,
                            managers: [],
                            advisors: [],
                            hasData: true,
                            colors: colors
                        };
                        
                        this.processedData.organizations.set(callName, orgData);
                        this.processedData.dataOrder.set(callName, index);
                        
                        ConfigUtils.debugLog(`ÁµÑÁπîËøΩÂä†: ${callName} (Level: ${level}, Parent: ${parent || '„Å™„Åó'}, Order: ${index})`, 'data');
                    }
                });
                
                ConfigUtils.debugLog(`ÁµÑÁπî„Éá„Éº„ÇøÊßãÁØâÂÆå‰∫Ü: ${this.processedData.organizations.size}ÁµÑÁπî`, 'data');
            }

            buildHierarchy() {
                ConfigUtils.debugLog('ÈöéÂ±§ÊßãÈÄ†ÊßãÁØâÈñãÂßã', 'data');
                
                this.processedData.organizations.forEach((orgData, orgName) => {
                    const parent = orgData.parent;
                    
                    if (parent && parent !== 'N/A') {
                        if (!this.processedData.hierarchy.has(parent)) {
                            this.processedData.hierarchy.set(parent, []);
                        }
                        
                        if (!this.processedData.hierarchy.get(parent).includes(orgName)) {
                            this.processedData.hierarchy.get(parent).push(orgName);
                            ConfigUtils.debugLog(`ÈöéÂ±§Èñ¢‰øÇËøΩÂä†: ${parent} ‚Üí ${orgName}`, 'data');
                        }
                    }
                });
                
                this.processedData.hierarchy.forEach((children, parent) => {
                    children.sort();
                });
                
                ConfigUtils.debugLog(`ÈöéÂ±§ÊßãÈÄ†ÊßãÁØâÂÆå‰∫Ü: ${this.processedData.hierarchy.size}„ÅÆË¶™ÁµÑÁπî`, 'data');
            }

            processManagersAndAdvisors() {
                ConfigUtils.debugLog('ÁÆ°ÁêÜËÄÖ„Éª„Ç¢„Éâ„Éê„Ç§„Ç∂ÊÉÖÂ†±Âá¶ÁêÜÈñãÂßãÔºà„ÉÅ„Éº„É†„Éú„Çπ„Éï„É©„Ç∞ÂØæÂøúÔºâ', 'data');
                
                this.rawData.forEach(row => {
                    const callName = row[7];
                    const name = row[2];
                    const role = row[9];
                    const roleJp = row[10];
                    const teamBossFlag = row[14];
                    const concurrent = row[15];
                    
                    if (!callName || !name || !role) return;
                    
                    const orgData = this.processedData.organizations.get(callName);
                    if (!orgData) return;
                    
                    const personData = {
                        name: name,
                        role: role,
                        roleJp: roleJp,
                        isTeamBoss: teamBossFlag === 'Y' || teamBossFlag === 'y' || teamBossFlag === '1',
                        isConcurrent: concurrent === 'Y' || concurrent === 'y' || concurrent === '1'
                    };
                    
                    let isManager = false;
                    let isAdvisor = false;
                    
                    if (personData.isTeamBoss) {
                        isManager = true;
                        ConfigUtils.debugLog(`„ÉÅ„Éº„É†„Éú„ÇπÂà§ÂÆö: ${callName} - ${name} (${role})`, 'data');
                    } else {
                        isManager = CONFIG.DATA_PROCESSING.MANAGER_KEYWORDS.some(keyword => 
                            role.toLowerCase().includes(keyword.toLowerCase())
                        );
                        
                        isAdvisor = CONFIG.DATA_PROCESSING.ADVISOR_KEYWORDS.some(keyword => 
                            role.toLowerCase().includes(keyword.toLowerCase())
                        );
                    }
                    
                    if (isManager) {
                        orgData.managers.push(personData);
                        ConfigUtils.debugLog(`ÁÆ°ÁêÜËÄÖËøΩÂä†: ${callName} - ${name} (${role}) [„Éú„Çπ:${personData.isTeamBoss}]`, 'data');
                    } else if (isAdvisor) {
                        orgData.advisors.push(personData);
                        ConfigUtils.debugLog(`„Ç¢„Éâ„Éê„Ç§„Ç∂ËøΩÂä†: ${callName} - ${name} (${role})`, 'data');
                    }
                });
                
                const managerCount = Array.from(this.processedData.organizations.values())
                    .reduce((count, org) => count + org.managers.length, 0);
                const advisorCount = Array.from(this.processedData.organizations.values())
                    .reduce((count, org) => count + org.advisors.length, 0);
                const teamBossCount = Array.from(this.processedData.organizations.values())
                    .reduce((count, org) => count + org.managers.filter(m => m.isTeamBoss).length, 0);
                    
                ConfigUtils.debugLog(`ÁÆ°ÁêÜËÄÖ„Éª„Ç¢„Éâ„Éê„Ç§„Ç∂Âá¶ÁêÜÂÆå‰∫Ü: ÁÆ°ÁêÜËÄÖ${managerCount}Âêç(„ÅÜ„Å°„ÉÅ„Éº„É†„Éú„Çπ${teamBossCount}Âêç), „Ç¢„Éâ„Éê„Ç§„Ç∂${advisorCount}Âêç`, 'data');
            }

            validateData() {
                ConfigUtils.debugLog('„Éá„Éº„ÇøÊ§úË®ºÈñãÂßã', 'data');
                this.checkCircularReferences();
                this.checkOrphanedOrganizations();
                this.checkDuplicates();
                ConfigUtils.debugLog(`„Éá„Éº„ÇøÊ§úË®ºÂÆå‰∫Ü: ${this.errors.length}ÂÄã„ÅÆ„Ç®„É©„Éº`, 'data');
            }

            checkCircularReferences() {
                this.processedData.organizations.forEach((orgData, orgName) => {
                    const visited = new Set();
                    let current = orgName;
                    
                    while (current) {
                        if (visited.has(current)) {
                            this.errors.push(`Âæ™Áí∞ÂèÇÁÖß„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„Åü: ${Array.from(visited).join(' ‚Üí ')} ‚Üí ${current}`);
                            break;
                        }
                        
                        visited.add(current);
                        const parentData = this.processedData.organizations.get(current);
                        current = parentData?.parent;
                    }
                });
            }

            checkOrphanedOrganizations() {
                this.processedData.organizations.forEach((orgData, orgName) => {
                    const parent = orgData.parent;
                    
                    if (parent && parent !== 'N/A' && !this.processedData.organizations.has(parent)) {
                        this.errors.push(`Â≠òÂú®„Åó„Å™„ÅÑË¶™ÁµÑÁπî„ÇíÂèÇÁÖß: ${orgName} ‚Üí ${parent}`);
                    }
                });
            }

            checkDuplicates() {
                const callNameGroups = new Map();
                
                this.rawData.forEach((row, index) => {
                    const callName = row[7];
                    const role = row[9];
                    const teamBossFlag = row[14];
                    
                    if (!callNameGroups.has(callName)) {
                        callNameGroups.set(callName, []);
                    }
                    
                    callNameGroups.get(callName).push({
                        row: row,
                        index: index,
                        role: role,
                        teamBossFlag: teamBossFlag
                    });
                });
                
                callNameGroups.forEach((group, callName) => {
                    if (group.length > 1) {
                        const isValidCombination = this.isValidRoleCombination(group);
                        
                        if (!isValidCombination) {
                            const rowNumbers = group.map(g => g.index + 2).join(', ');
                            this.errors.push(`‰∏çÊ≠£„Å™ÈáçË§áCall Name: ${callName} (Ë°å${rowNumbers}) - Âêå„ÅòÁµÑÁπîÂÜÖ„ÅßÂêå„ÅòÂΩπÂâ≤„ÅÆË§áÊï∞‰∫∫„Åæ„Åü„ÅØ‰∏çÊ≠£„Å™ÁµÑ„ÅøÂêà„Çè„Åõ`);
                        }
                    }
                });
            }

            isValidRoleCombination(group) {
                const managers = [];
                const advisors = [];
                const others = [];
                
                group.forEach(person => {
                    const role = person.role.toLowerCase();
                    const isTeamBoss = person.teamBossFlag === 'Y' || person.teamBossFlag === 'y' || person.teamBossFlag === '1';
                    
                    if (isTeamBoss) {
                        managers.push(person);
                    } else {
                        const isManager = CONFIG.DATA_PROCESSING.MANAGER_KEYWORDS.some(keyword => 
                            role.includes(keyword.toLowerCase())
                        );
                        const isAdvisor = CONFIG.DATA_PROCESSING.ADVISOR_KEYWORDS.some(keyword => 
                            role.includes(keyword.toLowerCase())
                        );
                        
                        if (isManager) {
                            managers.push(person);
                        } else if (isAdvisor) {
                            advisors.push(person);
                        } else {
                            others.push(person);
                        }
                    }
                });
                
                if (managers.length > 1 || advisors.length > 1 || others.length > 0) {
                    return false;
                }
                
                if ((managers.length <= 1) && (advisors.length <= 1)) {
                    return true;
                }
                
                return false;
            }

            getOrganizationList() {
                return Array.from(this.processedData.organizations.keys()).sort();
            }

            getOrganizationHierarchy(baseOrg, maxLevel = 0) {
                const result = new Set();
                const visited = new Set();
                
                const addOrgAndChildren = (orgName, currentLevel) => {
                    if (visited.has(orgName)) return;
                    if (maxLevel > 0 && currentLevel > maxLevel) return;
                    
                    visited.add(orgName);
                    
                    const orgData = this.processedData.organizations.get(orgName);
                    if (orgData && (!maxLevel || orgData.level <= maxLevel)) {
                        result.add(orgName);
                        
                        const children = this.processedData.hierarchy.get(orgName) || [];
                        children.forEach(child => {
                            addOrgAndChildren(child, currentLevel + 1);
                        });
                    }
                };
                
                addOrgAndChildren(baseOrg, 1);
                return Array.from(result);
            }

            getAllOrganizations(maxLevel = 0) {
                if (maxLevel === 0) {
                    return this.getOrganizationList();
                }
                
                return Array.from(this.processedData.organizations.entries())
                    .filter(([orgName, orgData]) => orgData.level <= maxLevel)
                    .map(([orgName, orgData]) => orgName)
                    .sort();
            }

            getProcessedData() {
                return this.processedData;
            }

            getErrors() {
                return [...this.errors];
            }

            getStatistics() {
                const totalRecords = this.rawData.length;
                const organizations = this.processedData.organizations.size;
                const managers = Array.from(this.processedData.organizations.values())
                    .reduce((count, org) => count + org.managers.length, 0);
                const maxLevel = Array.from(this.processedData.organizations.values())
                    .reduce((max, org) => Math.max(max, org.level), 0);
                const mappings = this.callNameMapping.size;
                const errors = this.errors.length;
                
                return {
                    totalRecords,
                    organizations,
                    managers,
                    maxLevel,
                    mappings,
                    errors,
                    customColors: 0,
                    colorPatterns: 0
                };
            }

            getRawData() {
                return this.rawData || [];
            }

            isDataProcessed() {
                return this.isProcessed && this.processedData.organizations.size > 0;
            }

            reset() {
                this.rawData = [];
                this.processedData = {
                    organizations: new Map(),
                    hierarchy: new Map(),
                    managers: new Map(),
                    advisors: new Map()
                };
                this.callNameMapping.clear();
                this.errors = [];
                this.isProcessed = false;
                
                ConfigUtils.debugLog('„Éá„Éº„Çø„Éó„É≠„Çª„ÉÉ„Çµ„Éº„Çí„É™„Çª„ÉÉ„Éà', 'data');
            }
        }

        // Global export
        window.DataProcessor = DataProcessor;

        console.log('Organization Chart Tool - Standalone Version - DataProcessor Loaded');

        // === BASIC APPLICATION FUNCTIONALITY ===
        
        // Application instance
        let app = null;

        // Basic functionality implementation
        function loadSampleData() {
            try {
                if (!app) {
                    app = { dataProcessor: new DataProcessor() };
                }
                app.dataProcessor.loadCorrectedSampleData();
                
                // Update UI
                updateOrganizationSelect();
                updateButtonStates('dataLoaded');
                showStats();
                
                alert(t('fileLoadComplete', { filename: 'Sample Data' }));
            } catch (error) {
                console.error('Sample data load error:', error);
                alert(t('error') + ': ' + error.message);
            }
        }

        function generateChart() {
            try {
                if (!app || !app.dataProcessor || !app.dataProcessor.isDataProcessed()) {
                    alert(t('noDataLoaded'));
                    return;
                }

                const baseOrg = document.getElementById('baseOrgSelect').value;
                const levelLimit = parseInt(document.getElementById('levelSelect').value) || 0;
                const hideManagers = document.getElementById('hideManagersCheckbox').checked;

                // Get target organizations
                let targetOrgs;
                if (baseOrg) {
                    targetOrgs = app.dataProcessor.getOrganizationHierarchy(baseOrg, levelLimit);
                } else {
                    targetOrgs = app.dataProcessor.getAllOrganizations(levelLimit);
                }

                // Simple chart rendering
                renderSimpleChart(targetOrgs, hideManagers);
                
                updateButtonStates('chartGenerated');
                alert(t('chartGenerated', { count: targetOrgs.length }));
                
            } catch (error) {
                console.error('Chart generation error:', error);
                alert(t('error') + ': ' + error.message);
            }
        }

        function renderSimpleChart(targetOrgs, hideManagers) {
            const chartContainer = document.getElementById('orgChart');
            chartContainer.innerHTML = '';

            if (!app || !app.dataProcessor) return;

            const processedData = app.dataProcessor.getProcessedData();
            
            targetOrgs.forEach((orgName, index) => {
                const orgData = processedData.organizations.get(orgName);
                if (!orgData) return;

                const orgElement = document.createElement('div');
                orgElement.style.cssText = `
                    border: 2px solid #333;
                    background: #f9f9f9;
                    padding: 10px;
                    margin: 10px;
                    border-radius: 4px;
                    display: inline-block;
                    min-width: 150px;
                    vertical-align: top;
                `;

                let content = `
                    <div style="background: #4a5568; color: white; padding: 5px; text-align: center; margin: -10px -10px 5px -10px; font-weight: bold;">
                        ${orgData.name}
                    </div>
                `;

                if (!hideManagers && orgData.managers.length > 0) {
                    content += `<div style="font-weight: bold; margin: 5px 0;">${orgData.managers[0].name}</div>`;
                    content += `<div style="font-size: 12px; color: #666;">${orgData.managers[0].role}</div>`;
                }

                if (orgData.longName && orgData.longName !== orgData.name) {
                    content += `<div style="font-size: 11px; color: #888; margin-top: 5px;">${orgData.longName}</div>`;
                }

                orgElement.innerHTML = content;
                chartContainer.appendChild(orgElement);
            });
        }

        function updateOrganizationSelect() {
            if (!app || !app.dataProcessor) return;

            const select = document.getElementById('baseOrgSelect');
            const organizations = app.dataProcessor.getOrganizationList();
            
            // Clear existing options except "Show All"
            select.innerHTML = `<option value="" data-i18n="showAll">${t('showAll')}</option>`;
            
            organizations.forEach(org => {
                const option = document.createElement('option');
                option.value = org;
                option.textContent = org;
                select.appendChild(option);
            });
        }

        function updateButtonStates(stage) {
            const buttons = {
                'showTableBtn': document.getElementById('showTableBtn'),
                'validateBtn': document.getElementById('validateBtn'),
                'generateBtn': document.getElementById('generateBtn'),
                'exportCurrentDataBtn': document.getElementById('exportCurrentDataBtn'),
                'exportSvgBtn': document.getElementById('exportSvgBtn'),
                'exportPngBtn': document.getElementById('exportPngBtn'),
                'exportHTMLBtn': document.getElementById('exportHTMLBtn'),
                'printBtn': document.getElementById('printBtn'),
                'fullscreenBtn': document.getElementById('fullscreenBtn')
            };

            switch (stage) {
                case 'initial':
                    Object.values(buttons).forEach(btn => btn && (btn.disabled = true));
                    break;
                case 'dataLoaded':
                    ['showTableBtn', 'validateBtn', 'generateBtn', 'exportCurrentDataBtn'].forEach(id => {
                        buttons[id] && (buttons[id].disabled = false);
                    });
                    break;
                case 'chartGenerated':
                    Object.values(buttons).forEach(btn => btn && (btn.disabled = false));
                    break;
            }
        }

        function showStats() {
            if (!app || !app.dataProcessor) return;

            const stats = app.dataProcessor.getStatistics();
            const statsElement = document.getElementById('statsContent');
            const statsContainer = document.getElementById('stats');
            
            if (statsElement && statsContainer) {
                statsElement.textContent = `${stats.totalRecords} records, ${stats.organizations} organizations, ${stats.managers} managers, Max level: ${stats.maxLevel}`;
                statsContainer.style.display = 'block';
            }
        }

        function exportEmptyTemplate() {
            alert('Export Empty Template functionality would be implemented here');
        }

        function exportCurrentData() {
            alert('Export Current Data functionality would be implemented here');
        }

        function exportSVG() {
            alert('Export SVG functionality would be implemented here');
        }

        function exportPNG() {
            alert('Export PNG functionality would be implemented here');
        }

        function exportHTML() {
            alert('Export HTML functionality would be implemented here');
        }

        function printChart() {
            window.print();
        }

        function toggleFullscreen() {
            const container = document.querySelector('.container');
            if (!document.fullscreenElement) {
                container.requestFullscreen().catch(err => {
                    alert(`Error attempting to enable fullscreen: ${err.message}`);
                });
            } else {
                document.exitFullscreen();
            }
        }

        function hideDataTable() {
            const section = document.getElementById('dataTableSection');
            if (section) {
                section.style.display = 'none';
            }
        }

        function addNewRow() {
            alert('Add New Row functionality would be implemented here');
        }

        function applyChanges() {
            alert('Apply Changes functionality would be implemented here');
        }

        // Usage Instructions Toggle
        function toggleUsageInstructions() {
            const instructions = document.getElementById('usageInstructions');
            const showContainer = document.querySelector('.show-instructions-container');
            
            if (instructions.style.display === 'none') {
                instructions.style.display = 'block';
                showContainer.style.display = 'none';
            } else {
                instructions.style.display = 'none';
                showContainer.style.display = 'block';
            }
        }

        // File handling
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize language system
            LanguageManager.initialize();
            
            // Set up file input
            const fileInput = document.getElementById('fileInput');
            const dropZone = document.getElementById('dropZone');
            
            if (fileInput && dropZone) {
                dropZone.addEventListener('click', () => fileInput.click());
                
                fileInput.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        handleFileUpload(file);
                    }
                });
                
                // Drag and drop
                dropZone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    dropZone.classList.add('dragover');
                });
                
                dropZone.addEventListener('dragleave', () => {
                    dropZone.classList.remove('dragover');
                });
                
                dropZone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    dropZone.classList.remove('dragover');
                    const file = e.dataTransfer.files[0];
                    if (file) {
                        handleFileUpload(file);
                    }
                });
            }
            
            // Initialize button states
            updateButtonStates('initial');
            
            console.log('Organization Chart Tool initialized successfully');
        });

        async function handleFileUpload(file) {
            try {
                if (!app) {
                    app = { dataProcessor: new DataProcessor() };
                }
                
                await app.dataProcessor.processExcelFile(file);
                updateOrganizationSelect();
                updateButtonStates('dataLoaded');
                showStats();
                
                alert(t('fileLoadComplete', { filename: file.name }));
            } catch (error) {
                console.error('File upload error:', error);
                alert(t('error') + ': ' + error.message);
            }
        }

        console.log('Organization Chart Tool - Standalone Version - Basic Functionality Loaded');
    </script>

    <script>
        // Global function definitions (for direct HTML calls)
        function validateData() {
            if (window.app && window.app.uiController) {
                window.app.uiController.validateData();
            } else {
                alert('Application not initialized');
            }
        }
        
        function showDataTable() {
            if (window.app && window.app.uiController) {
                window.app.uiController.showDataTable();
            } else {
                alert('Application not initialized');
            }
        }
        
        // Check for demo mode parameters
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('demo') === 'true') {
            // Demo mode flag processing is executed in main.js
            console.log('Opening page in demo mode');
        }
        
        // Debug information display for development
        if (urlParams.get('debug') === 'true') {
            console.log('Debug mode enabled');
        }
    </script>
</body>
</html>